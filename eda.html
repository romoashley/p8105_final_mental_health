<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Exploratory Data Analysis (EDA)</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="site_libs/plotly-binding-4.10.3/plotly.js"></script>
<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="eda.html">Exploratory Analysis</a>
</li>
<li>
  <a href="statistical_analysis.html">Statistical Analysis</a>
</li>
<li>
  <a href="report.html">Final Report</a>
</li>
<li>
  <a href="about.html">About Us</a>
</li>
<li>
  <a href="http://github.com/&lt;romoashley/p8105_final_mental_health&gt;/">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Exploratory Data Analysis (EDA)</h1>

</div>


<pre><code>##  [1] &quot;#440154FF&quot; &quot;#482878FF&quot; &quot;#3E4A89FF&quot; &quot;#31688EFF&quot; &quot;#26828EFF&quot; &quot;#1F9E89FF&quot;
##  [7] &quot;#35B779FF&quot; &quot;#6DCD59FF&quot; &quot;#B4DE2CFF&quot; &quot;#FDE725FF&quot;</code></pre>
<div id="national-averages" class="section level2">
<h2>National Averages</h2>
<pre class="r"><code>avg_year =
  tidydata |&gt; 
  filter(state == &quot;United States&quot;) |&gt; 
  select(indicator, year, week_number, value, start_dates) |&gt; 
  group_by(year, start_dates, indicator) |&gt; 
  summarize(
    mean = mean(value),
    indicator_total = n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;year&#39;, &#39;start_dates&#39;. You can override
## using the `.groups` argument.</code></pre>
<pre class="r"><code># plot average for each start date for each indicator
avg_year |&gt; 
  ggplot(aes(x = start_dates, y = mean, color = indicator)) +
  geom_point() +
  labs(
    x = &quot;Start Date&quot;,
    y = &quot;Average Value&quot;,
    title = &quot;National Average (2020-2022)&quot;) +
  theme(
    legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(angle=90, hjust=1),
    strip.text = element_text(size = 4)) +
  guides(color = guide_legend(nrow = 2))</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-2-1.png" width="90%" /></p>
<p>On average, those who took prescription medication for mental health
and/or received counseling or therapy had a highest values while those
who received counseling or therapy had the lowest value.</p>
<div id="confidence-intervals" class="section level3">
<h3>Confidence Intervals</h3>
<p>I relabeled the observations for the variable indicator to “received”
if they did obtain the mental health services they needed and “not
received” if they did not obtain the mental health services they
needed.</p>
<pre class="r"><code>received_service = 
  tidydata |&gt; 
  mutate(
    resolution = case_when(
      indicator == &quot;Took Prescription Medication for Mental Health&quot; ~ &quot;received&quot;,
      indicator == &quot;Received Counseling or Therapy&quot; ~ &quot;received&quot;,
      indicator == &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy&quot; ~ &quot;received&quot;,
      indicator == &quot;Needed Counseling or Therapy But Did Not Get It&quot; ~ &quot;not received&quot;))</code></pre>
<p>I created a data frame where I grouped by states to determine the
number of total services, which includes the services received as well
as the number of services not received.</p>
<pre class="r"><code>states_df =
  received_service |&gt; 
  select(state, indicator, resolution) |&gt; 
  filter(state != &quot;United States&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(
    services_total = n(),
    services_not_received = sum(resolution == &quot;not received&quot;))</code></pre>
<p>Now, I focus on the state of New York. Using the
<code>prop.test</code> and <code>broom::tidy</code> functions, I obtain
an estimate and CI of the proportion of mental health services not
received in New York (shown in the table below).</p>
<pre class="r"><code>ny_test = 
  prop.test(
    x = filter(states_df, state == &quot;New York&quot;) %&gt;% pull(services_not_received),
    n = filter(states_df, state == &quot;New York&quot;) %&gt;% pull(services_total)) 

broom::tidy(ny_test) %&gt;% 
  knitr::kable(digits = 3)</code></pre>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="7%" />
<col width="8%" />
<col width="43%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">estimate</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
<th align="right">parameter</th>
<th align="right">conf.low</th>
<th align="right">conf.high</th>
<th align="left">method</th>
<th align="left">alternative</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.25</td>
<td align="right">32.008</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">0.181</td>
<td align="right">0.334</td>
<td align="left">1-sample proportions test with continuity
correction</td>
<td align="left">two.sided</td>
</tr>
</tbody>
</table>
<p>I apply prop.test and broom:tidy to obtain estimates and confidence
intervals for the proportion of mental health services not received for
each state.</p>
<p>***need to add rest of code: 2 chunks for services_states</p>
</div>
</div>
<div id="disaggregations-by-state" class="section level2">
<h2>Disaggregations by State</h2>
<p>This EDA will analyze mental health care access trends by state.</p>
<p>I will first create a dataframe that only includes state-level
observations.</p>
<pre class="r"><code>state_df =
  tidydata |&gt; 
  filter(group == &quot;State&quot;)</code></pre>
<div id="indicator-1-took-prescription" class="section level3">
<h3>Indicator 1: Took prescription</h3>
<p>Let’s start with the mental health indicator “Took Prescription
Medication for Mental Health”</p>
<p>The following chunk shows the top five states with the highest mean
percentage of respondents who reported taking prescription medication
for mental health from 2020-2022.</p>
<pre class="r"><code>state_meds_top5 =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(desc(mean_value)) |&gt; 
  top_n(5) </code></pre>
<pre><code>## Selecting by mean_value</code></pre>
<pre class="r"><code>state_meds_top5 |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">mean_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">West Virginia</td>
<td align="right">28.84848</td>
</tr>
<tr class="even">
<td align="left">Kentucky</td>
<td align="right">27.37879</td>
</tr>
<tr class="odd">
<td align="left">Arkansas</td>
<td align="right">26.69091</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="right">25.75455</td>
</tr>
<tr class="odd">
<td align="left">Oklahoma</td>
<td align="right">25.70909</td>
</tr>
</tbody>
</table>
<p>Let’s visualize a heat map of this indicator’s prevalence by US
state.</p>
<p>First, we’ll merge the filtered dataset with an existing US state map
dataset to assist with mapping.</p>
<pre class="r"><code>state_meds =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  mutate(state = tolower(state))

usa = 
  st_as_sf(map(&quot;state&quot;, fill = TRUE, plot = FALSE))

us_meds =
  merge(usa, state_meds, by.x = &quot;ID&quot;, by.y = &quot;state&quot;, all.x = TRUE)</code></pre>
<p>Next, we’ll plot the data using ggplot</p>
<pre class="r"><code>heatmap_meds=
ggplot(us_meds)+
  geom_sf(aes(fill = mean_value), color = &quot;white&quot;, size = 0.2)+
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;red&quot;, na.value = &quot;grey50&quot;, name = &quot;Avg % taking prescription medications&quot;)+
  theme_minimal()+
  theme(legend.position = &quot;right&quot;,
        plot.title.position = &quot;plot&quot;)+
  labs(title = &quot;Average % used prescription medication for mental health 2020-2022, by state&quot;)

print(heatmap_meds)</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-9-1.png" width="90%" /></p>
<p>We can also look at which states have had the greatest change in
medication use. This shows that not only does WV have the highest
prevalence of medication use for mental health during this period, but
it also has had the highest level of change in this indicator between
2020-2022.</p>
<pre class="r"><code>state_meds_change =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health&quot;, year != &quot;2021&quot;) |&gt; 
  group_by(state, year) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(state, year) |&gt; 
  mutate(val_change = c(NA, diff(mean_value)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>state_meds_change |&gt; 
  filter(!is.na(val_change)) |&gt; 
  ungroup() |&gt; 
  select(-year, -mean_value) |&gt; 
  slice_max(order_by = val_change, n=5) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">val_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">West Virginia</td>
<td align="right">7.044444</td>
</tr>
<tr class="even">
<td align="left">Nebraska</td>
<td align="right">5.219444</td>
</tr>
<tr class="odd">
<td align="left">North Dakota</td>
<td align="right">5.136111</td>
</tr>
<tr class="even">
<td align="left">Minnesota</td>
<td align="right">4.502778</td>
</tr>
<tr class="odd">
<td align="left">Kentucky</td>
<td align="right">4.452778</td>
</tr>
</tbody>
</table>
<p>Let’s take a look at the trend for this indicator over time.</p>
<pre class="r"><code>state_df |&gt;
  filter(indicator == &quot;Took Prescription Medication for Mental Health&quot;) |&gt; 
  group_by(state, year) |&gt;
  summarize(mean_value = mean(value)) |&gt; 
  mutate(year = factor(year)) |&gt; 
plot_ly(x = ~year, y = ~mean_value, color = ~state, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;) |&gt;
  layout(
    title = &quot;% used prescription medication for mental health by state &amp; year&quot;,
    xaxis = list(title = &quot;Year&quot;),
    yaxis = list(title = &quot;Average % used prescription medication for mental health&quot;))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-314ebe593a7e9a238ca4" style="width:90%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-314ebe593a7e9a238ca4">{"x":{"visdat":{"2f162961218c":["function () ","plotlyVisDat"]},"cur_data":"2f162961218c","attrs":{"2f162961218c":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"% used prescription medication for mental health by state & year","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2020","2021","2022"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average % used prescription medication for mental health"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2020","2021","2022"],"y":[24.322222222222223,24.614999999999998,27.300000000000001],"mode":"lines+markers","type":"scatter","name":"Alabama","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[17.011111111111113,18.460000000000001,18.725000000000001],"mode":"lines+markers","type":"scatter","name":"Alaska","marker":{"color":"rgba(135,188,155,1)","line":{"color":"rgba(135,188,155,1)"}},"textfont":{"color":"rgba(135,188,155,1)"},"error_y":{"color":"rgba(135,188,155,1)"},"error_x":{"color":"rgba(135,188,155,1)"},"line":{"color":"rgba(135,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[19.277777777777779,20.355,20.175000000000001],"mode":"lines+markers","type":"scatter","name":"Arizona","marker":{"color":"rgba(161,182,146,1)","line":{"color":"rgba(161,182,146,1)"}},"textfont":{"color":"rgba(161,182,146,1)"},"error_y":{"color":"rgba(161,182,146,1)"},"error_x":{"color":"rgba(161,182,146,1)"},"line":{"color":"rgba(161,182,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.455555555555556,26.949999999999999,28.175000000000001],"mode":"lines+markers","type":"scatter","name":"Arkansas","marker":{"color":"rgba(182,175,137,1)","line":{"color":"rgba(182,175,137,1)"}},"textfont":{"color":"rgba(182,175,137,1)"},"error_y":{"color":"rgba(182,175,137,1)"},"error_x":{"color":"rgba(182,175,137,1)"},"line":{"color":"rgba(182,175,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[16.822222222222223,16.800000000000001,17.924999999999997],"mode":"lines+markers","type":"scatter","name":"California","marker":{"color":"rgba(201,168,127,1)","line":{"color":"rgba(201,168,127,1)"}},"textfont":{"color":"rgba(201,168,127,1)"},"error_y":{"color":"rgba(201,168,127,1)"},"error_x":{"color":"rgba(201,168,127,1)"},"line":{"color":"rgba(201,168,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.344444444444445,21.949999999999999,21.550000000000001],"mode":"lines+markers","type":"scatter","name":"Colorado","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"line":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.5,21.405000000000001,23.875],"mode":"lines+markers","type":"scatter","name":"Connecticut","marker":{"color":"rgba(235,152,109,1)","line":{"color":"rgba(235,152,109,1)"}},"textfont":{"color":"rgba(235,152,109,1)"},"error_y":{"color":"rgba(235,152,109,1)"},"error_x":{"color":"rgba(235,152,109,1)"},"line":{"color":"rgba(235,152,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.355555555555554,21.379999999999999,22.649999999999999],"mode":"lines+markers","type":"scatter","name":"Delaware","marker":{"color":"rgba(250,142,99,1)","line":{"color":"rgba(250,142,99,1)"}},"textfont":{"color":"rgba(250,142,99,1)"},"error_y":{"color":"rgba(250,142,99,1)"},"error_x":{"color":"rgba(250,142,99,1)"},"line":{"color":"rgba(250,142,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[18.31111111111111,20.114999999999998,21.050000000000001],"mode":"lines+markers","type":"scatter","name":"District of Columbia","marker":{"color":"rgba(242,144,111,1)","line":{"color":"rgba(242,144,111,1)"}},"textfont":{"color":"rgba(242,144,111,1)"},"error_y":{"color":"rgba(242,144,111,1)"},"error_x":{"color":"rgba(242,144,111,1)"},"line":{"color":"rgba(242,144,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[19.222222222222221,19.68,21.149999999999999],"mode":"lines+markers","type":"scatter","name":"Florida","marker":{"color":"rgba(230,147,126,1)","line":{"color":"rgba(230,147,126,1)"}},"textfont":{"color":"rgba(230,147,126,1)"},"error_y":{"color":"rgba(230,147,126,1)"},"error_x":{"color":"rgba(230,147,126,1)"},"line":{"color":"rgba(230,147,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.711111111111112,21.09,20.225000000000001],"mode":"lines+markers","type":"scatter","name":"Georgia","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"line":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[12.177777777777777,13.164999999999999,13.175000000000001],"mode":"lines+markers","type":"scatter","name":"Hawaii","marker":{"color":"rgba(203,152,155,1)","line":{"color":"rgba(203,152,155,1)"}},"textfont":{"color":"rgba(203,152,155,1)"},"error_y":{"color":"rgba(203,152,155,1)"},"error_x":{"color":"rgba(203,152,155,1)"},"line":{"color":"rgba(203,152,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.877777777777776,24.100000000000001,23.699999999999999],"mode":"lines+markers","type":"scatter","name":"Idaho","marker":{"color":"rgba(187,155,170,1)","line":{"color":"rgba(187,155,170,1)"}},"textfont":{"color":"rgba(187,155,170,1)"},"error_y":{"color":"rgba(187,155,170,1)"},"error_x":{"color":"rgba(187,155,170,1)"},"line":{"color":"rgba(187,155,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[19.333333333333332,21.219999999999999,22.149999999999999],"mode":"lines+markers","type":"scatter","name":"Illinois","marker":{"color":"rgba(169,157,184,1)","line":{"color":"rgba(169,157,184,1)"}},"textfont":{"color":"rgba(169,157,184,1)"},"error_y":{"color":"rgba(169,157,184,1)"},"error_x":{"color":"rgba(169,157,184,1)"},"line":{"color":"rgba(169,157,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.81111111111111,25.780000000000001,27.524999999999999],"mode":"lines+markers","type":"scatter","name":"Indiana","marker":{"color":"rgba(148,159,199,1)","line":{"color":"rgba(148,159,199,1)"}},"textfont":{"color":"rgba(148,159,199,1)"},"error_y":{"color":"rgba(148,159,199,1)"},"error_x":{"color":"rgba(148,159,199,1)"},"line":{"color":"rgba(148,159,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.977777777777778,25.484999999999999,26.725000000000001],"mode":"lines+markers","type":"scatter","name":"Iowa","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"line":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.333333333333332,24.125,26.550000000000001],"mode":"lines+markers","type":"scatter","name":"Kansas","marker":{"color":"rgba(166,156,201,1)","line":{"color":"rgba(166,156,201,1)"}},"textfont":{"color":"rgba(166,156,201,1)"},"error_y":{"color":"rgba(166,156,201,1)"},"error_x":{"color":"rgba(166,156,201,1)"},"line":{"color":"rgba(166,156,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.622222222222224,27.629999999999999,30.074999999999999],"mode":"lines+markers","type":"scatter","name":"Kentucky","marker":{"color":"rgba(179,153,200,1)","line":{"color":"rgba(179,153,200,1)"}},"textfont":{"color":"rgba(179,153,200,1)"},"error_y":{"color":"rgba(179,153,200,1)"},"error_x":{"color":"rgba(179,153,200,1)"},"line":{"color":"rgba(179,153,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.700000000000003,25.855,25.274999999999999],"mode":"lines+markers","type":"scatter","name":"Louisiana","marker":{"color":"rgba(192,150,199,1)","line":{"color":"rgba(192,150,199,1)"}},"textfont":{"color":"rgba(192,150,199,1)"},"error_y":{"color":"rgba(192,150,199,1)"},"error_x":{"color":"rgba(192,150,199,1)"},"line":{"color":"rgba(192,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.633333333333333,25.52,28.949999999999999],"mode":"lines+markers","type":"scatter","name":"Maine","marker":{"color":"rgba(204,147,198,1)","line":{"color":"rgba(204,147,198,1)"}},"textfont":{"color":"rgba(204,147,198,1)"},"error_y":{"color":"rgba(204,147,198,1)"},"error_x":{"color":"rgba(204,147,198,1)"},"line":{"color":"rgba(204,147,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[18.977777777777778,20.775000000000002,21.824999999999999],"mode":"lines+markers","type":"scatter","name":"Maryland","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.800000000000001,23.460000000000001,25.024999999999999],"mode":"lines+markers","type":"scatter","name":"Massachusetts","marker":{"color":"rgba(226,140,195,1)","line":{"color":"rgba(226,140,195,1)"}},"textfont":{"color":"rgba(226,140,195,1)"},"error_y":{"color":"rgba(226,140,195,1)"},"error_x":{"color":"rgba(226,140,195,1)"},"line":{"color":"rgba(226,140,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.222222222222221,22.895,24.674999999999997],"mode":"lines+markers","type":"scatter","name":"Michigan","marker":{"color":"rgba(228,146,187,1)","line":{"color":"rgba(228,146,187,1)"}},"textfont":{"color":"rgba(228,146,187,1)"},"error_y":{"color":"rgba(228,146,187,1)"},"error_x":{"color":"rgba(228,146,187,1)"},"line":{"color":"rgba(228,146,187,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.422222222222221,24.105,26.925000000000001],"mode":"lines+markers","type":"scatter","name":"Minnesota","marker":{"color":"rgba(221,158,173,1)","line":{"color":"rgba(221,158,173,1)"}},"textfont":{"color":"rgba(221,158,173,1)"},"error_y":{"color":"rgba(221,158,173,1)"},"error_x":{"color":"rgba(221,158,173,1)"},"line":{"color":"rgba(221,158,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.87777777777778,23.954999999999998,23.300000000000001],"mode":"lines+markers","type":"scatter","name":"Mississippi","marker":{"color":"rgba(214,170,159,1)","line":{"color":"rgba(214,170,159,1)"}},"textfont":{"color":"rgba(214,170,159,1)"},"error_y":{"color":"rgba(214,170,159,1)"},"error_x":{"color":"rgba(214,170,159,1)"},"line":{"color":"rgba(214,170,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.577777777777779,25.390000000000001,25.175000000000001],"mode":"lines+markers","type":"scatter","name":"Missouri","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.477777777777778,22.164999999999999,21.324999999999999],"mode":"lines+markers","type":"scatter","name":"Montana","marker":{"color":"rgba(196,191,129,1)","line":{"color":"rgba(196,191,129,1)"}},"textfont":{"color":"rgba(196,191,129,1)"},"error_y":{"color":"rgba(196,191,129,1)"},"error_x":{"color":"rgba(196,191,129,1)"},"line":{"color":"rgba(196,191,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.055555555555554,23.625,27.274999999999999],"mode":"lines+markers","type":"scatter","name":"Nebraska","marker":{"color":"rgba(186,201,113,1)","line":{"color":"rgba(186,201,113,1)"}},"textfont":{"color":"rgba(186,201,113,1)"},"error_y":{"color":"rgba(186,201,113,1)"},"error_x":{"color":"rgba(186,201,113,1)"},"line":{"color":"rgba(186,201,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[17.111111111111111,17.57,17.899999999999999],"mode":"lines+markers","type":"scatter","name":"Nevada","marker":{"color":"rgba(174,211,95,1)","line":{"color":"rgba(174,211,95,1)"}},"textfont":{"color":"rgba(174,211,95,1)"},"error_y":{"color":"rgba(174,211,95,1)"},"error_x":{"color":"rgba(174,211,95,1)"},"line":{"color":"rgba(174,211,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.622222222222224,24.245000000000001,26.024999999999999],"mode":"lines+markers","type":"scatter","name":"New Hampshire","marker":{"color":"rgba(172,216,82,1)","line":{"color":"rgba(172,216,82,1)"}},"textfont":{"color":"rgba(172,216,82,1)"},"error_y":{"color":"rgba(172,216,82,1)"},"error_x":{"color":"rgba(172,216,82,1)"},"line":{"color":"rgba(172,216,82,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[18.055555555555554,17.895,19.424999999999997],"mode":"lines+markers","type":"scatter","name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.544444444444444,20.760000000000002,20.875],"mode":"lines+markers","type":"scatter","name":"New Mexico","marker":{"color":"rgba(198,217,73,1)","line":{"color":"rgba(198,217,73,1)"}},"textfont":{"color":"rgba(198,217,73,1)"},"error_y":{"color":"rgba(198,217,73,1)"},"error_x":{"color":"rgba(198,217,73,1)"},"line":{"color":"rgba(198,217,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[17.211111111111112,18.699999999999999,19.699999999999999],"mode":"lines+markers","type":"scatter","name":"New York","marker":{"color":"rgba(211,217,68,1)","line":{"color":"rgba(211,217,68,1)"}},"textfont":{"color":"rgba(211,217,68,1)"},"error_y":{"color":"rgba(211,217,68,1)"},"error_x":{"color":"rgba(211,217,68,1)"},"line":{"color":"rgba(211,217,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.288888888888888,24.219999999999999,23.5],"mode":"lines+markers","type":"scatter","name":"North Carolina","marker":{"color":"rgba(223,217,63,1)","line":{"color":"rgba(223,217,63,1)"}},"textfont":{"color":"rgba(223,217,63,1)"},"error_y":{"color":"rgba(223,217,63,1)"},"error_x":{"color":"rgba(223,217,63,1)"},"line":{"color":"rgba(223,217,63,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.488888888888891,23.690000000000001,25.625],"mode":"lines+markers","type":"scatter","name":"North Dakota","marker":{"color":"rgba(235,217,58,1)","line":{"color":"rgba(235,217,58,1)"}},"textfont":{"color":"rgba(235,217,58,1)"},"error_y":{"color":"rgba(235,217,58,1)"},"error_x":{"color":"rgba(235,217,58,1)"},"line":{"color":"rgba(235,217,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.533333333333331,24.009999999999998,25.524999999999999],"mode":"lines+markers","type":"scatter","name":"Ohio","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"line":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.166666666666668,25.945,28],"mode":"lines+markers","type":"scatter","name":"Oklahoma","marker":{"color":"rgba(254,216,53,1)","line":{"color":"rgba(254,216,53,1)"}},"textfont":{"color":"rgba(254,216,53,1)"},"error_y":{"color":"rgba(254,216,53,1)"},"error_x":{"color":"rgba(254,216,53,1)"},"line":{"color":"rgba(254,216,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.711111111111112,23.870000000000001,25.125],"mode":"lines+markers","type":"scatter","name":"Oregon","marker":{"color":"rgba(251,213,72,1)","line":{"color":"rgba(251,213,72,1)"}},"textfont":{"color":"rgba(251,213,72,1)"},"error_y":{"color":"rgba(251,213,72,1)"},"error_x":{"color":"rgba(251,213,72,1)"},"line":{"color":"rgba(251,213,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.411111111111111,24.454999999999998,25.824999999999999],"mode":"lines+markers","type":"scatter","name":"Pennsylvania","marker":{"color":"rgba(248,210,88,1)","line":{"color":"rgba(248,210,88,1)"}},"textfont":{"color":"rgba(248,210,88,1)"},"error_y":{"color":"rgba(248,210,88,1)"},"error_x":{"color":"rgba(248,210,88,1)"},"line":{"color":"rgba(248,210,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.122222222222224,25.719999999999999,25.274999999999999],"mode":"lines+markers","type":"scatter","name":"Rhode Island","marker":{"color":"rgba(245,207,101,1)","line":{"color":"rgba(245,207,101,1)"}},"textfont":{"color":"rgba(245,207,101,1)"},"error_y":{"color":"rgba(245,207,101,1)"},"error_x":{"color":"rgba(245,207,101,1)"},"line":{"color":"rgba(245,207,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.577777777777779,23.805,24.774999999999999],"mode":"lines+markers","type":"scatter","name":"South Carolina","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"line":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.977777777777778,22.105,24.5],"mode":"lines+markers","type":"scatter","name":"South Dakota","marker":{"color":"rgba(237,201,126,1)","line":{"color":"rgba(237,201,126,1)"}},"textfont":{"color":"rgba(237,201,126,1)"},"error_y":{"color":"rgba(237,201,126,1)"},"error_x":{"color":"rgba(237,201,126,1)"},"line":{"color":"rgba(237,201,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.31111111111111,24.675000000000001,25.074999999999999],"mode":"lines+markers","type":"scatter","name":"Tennessee","marker":{"color":"rgba(233,198,138,1)","line":{"color":"rgba(233,198,138,1)"}},"textfont":{"color":"rgba(233,198,138,1)"},"error_y":{"color":"rgba(233,198,138,1)"},"error_x":{"color":"rgba(233,198,138,1)"},"line":{"color":"rgba(233,198,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[18.644444444444446,18.899999999999999,20.949999999999999],"mode":"lines+markers","type":"scatter","name":"Texas","marker":{"color":"rgba(228,196,149,1)","line":{"color":"rgba(228,196,149,1)"}},"textfont":{"color":"rgba(228,196,149,1)"},"error_y":{"color":"rgba(228,196,149,1)"},"error_x":{"color":"rgba(228,196,149,1)"},"line":{"color":"rgba(228,196,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.544444444444444,25.809999999999999,28.199999999999999],"mode":"lines+markers","type":"scatter","name":"Utah","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"line":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.144444444444442,24.489999999999998,23.925000000000001],"mode":"lines+markers","type":"scatter","name":"Vermont","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.744444444444444,21.559999999999999,23.925000000000001],"mode":"lines+markers","type":"scatter","name":"Virginia","marker":{"color":"rgba(208,188,162,1)","line":{"color":"rgba(208,188,162,1)"}},"textfont":{"color":"rgba(208,188,162,1)"},"error_y":{"color":"rgba(208,188,162,1)"},"error_x":{"color":"rgba(208,188,162,1)"},"line":{"color":"rgba(208,188,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.511111111111109,22.289999999999999,23.125],"mode":"lines+markers","type":"scatter","name":"Washington","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"line":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[27.155555555555555,28.539999999999999,34.200000000000003],"mode":"lines+markers","type":"scatter","name":"West Virginia","marker":{"color":"rgba(194,184,171,1)","line":{"color":"rgba(194,184,171,1)"}},"textfont":{"color":"rgba(194,184,171,1)"},"error_y":{"color":"rgba(194,184,171,1)"},"error_x":{"color":"rgba(194,184,171,1)"},"line":{"color":"rgba(194,184,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.577777777777779,22.77,25.425000000000001],"mode":"lines+markers","type":"scatter","name":"Wisconsin","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"textfont":{"color":"rgba(187,181,175,1)"},"error_y":{"color":"rgba(187,181,175,1)"},"error_x":{"color":"rgba(187,181,175,1)"},"line":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[20.511111111111113,20.850000000000001,20.100000000000001],"mode":"lines+markers","type":"scatter","name":"Wyoming","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="indicator-2-received-counseling-or-therapy"
class="section level3">
<h3>Indicator 2: Received Counseling or Therapy</h3>
<p>Now we’ll look at the mental health indicator “Received Counseling or
Therapy”</p>
<p>The following chunk shows the top five states with the highest mean
percentage of respondents who reported receiving counseling or therapy
from 2020-2022. The state with the highest percentage during this period
was District of Columbia.</p>
<pre class="r"><code>state_ther_top5 =
  state_df |&gt; 
  filter(indicator == &quot;Received Counseling or Therapy&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(desc(mean_value)) |&gt; 
  top_n(5) </code></pre>
<pre><code>## Selecting by mean_value</code></pre>
<pre class="r"><code>state_ther_top5 |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">mean_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">District of Columbia</td>
<td align="right">18.08182</td>
</tr>
<tr class="even">
<td align="left">Massachusetts</td>
<td align="right">14.92727</td>
</tr>
<tr class="odd">
<td align="left">Rhode Island</td>
<td align="right">14.24848</td>
</tr>
<tr class="even">
<td align="left">Vermont</td>
<td align="right">13.72121</td>
</tr>
<tr class="odd">
<td align="left">Oregon</td>
<td align="right">12.97273</td>
</tr>
</tbody>
</table>
<p>Let’s visualize a heat map of this indicator’s prevalence by US
state.</p>
<p>First, we’ll merge the filtered dataset with an existing US state map
dataset to assist with mapping.</p>
<pre class="r"><code>state_ther =
  state_df |&gt; 
  filter(indicator == &quot;Received Counseling or Therapy&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  mutate(state = tolower(state))

usa = 
  st_as_sf(map(&quot;state&quot;, fill = TRUE, plot = FALSE))

us_ther =
  merge(usa, state_ther, by.x = &quot;ID&quot;, by.y = &quot;state&quot;, all.x = TRUE)</code></pre>
<p>Next, we’ll plot the data using ggplot</p>
<pre class="r"><code>heatmap_ther=
ggplot(us_ther)+
  geom_sf(aes(fill = mean_value), color = &quot;white&quot;, size = 0.2)+
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;red&quot;, na.value = &quot;grey50&quot;, name = &quot;Avg % receiving therapy&quot;)+
  theme_minimal()+
  theme(legend.position = &quot;right&quot;,
        plot.title.position = &quot;plot&quot;)+
  labs(title = &quot;Average % receiving counseling or therapy 2020-2022, by state&quot;)

print(heatmap_ther)</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-14-1.png" width="90%" /></p>
<p>We can also look at which states have had the greatest change in
therapy use. This shows that NE had the highest level of change in this
indicator between 2020-2022. It also had a high level of change in
indicator 1</p>
<pre class="r"><code>state_ther_change =
  state_df |&gt; 
  filter(indicator == &quot;Received Counseling or Therapy&quot;, year != &quot;2021&quot;) |&gt; 
  group_by(state, year) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(state, year) |&gt; 
  mutate(val_change = c(NA, diff(mean_value)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>state_ther_change |&gt; 
  filter(!is.na(val_change)) |&gt; 
  ungroup() |&gt; 
  select(-year, -mean_value) |&gt; 
  slice_max(order_by = val_change, n=5) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">val_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Nebraska</td>
<td align="right">4.369444</td>
</tr>
<tr class="even">
<td align="left">North Dakota</td>
<td align="right">3.922222</td>
</tr>
<tr class="odd">
<td align="left">Montana</td>
<td align="right">3.694444</td>
</tr>
<tr class="even">
<td align="left">Oklahoma</td>
<td align="right">3.091667</td>
</tr>
<tr class="odd">
<td align="left">Delaware</td>
<td align="right">2.661111</td>
</tr>
</tbody>
</table>
<p>Let’s take a look at the trend for this indicator over time.</p>
<pre class="r"><code>state_df |&gt;
  filter(indicator == &quot;Received Counseling or Therapy&quot;) |&gt; 
  group_by(state, year) |&gt;
  summarize(mean_value = mean(value)) |&gt; 
  mutate(year = factor(year)) |&gt; 
plot_ly(x = ~year, y = ~mean_value, color = ~state, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;) |&gt;
  layout(
    title = &quot;% received counseling or therapy by state &amp; year&quot;,
    xaxis = list(title = &quot;Year&quot;),
    yaxis = list(title = &quot;Average % received therapy&quot;))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-39cda2268234fc96e273" style="width:90%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-39cda2268234fc96e273">{"x":{"visdat":{"2f162ccae3fe":["function () ","plotlyVisDat"]},"cur_data":"2f162ccae3fe","attrs":{"2f162ccae3fe":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"% received counseling or therapy by state & year","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2020","2021","2022"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average % received therapy"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2020","2021","2022"],"y":[7.8444444444444441,8.9450000000000003,10.375],"mode":"lines+markers","type":"scatter","name":"Alabama","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.5333333333333332,10.77,10.85],"mode":"lines+markers","type":"scatter","name":"Alaska","marker":{"color":"rgba(135,188,155,1)","line":{"color":"rgba(135,188,155,1)"}},"textfont":{"color":"rgba(135,188,155,1)"},"error_y":{"color":"rgba(135,188,155,1)"},"error_x":{"color":"rgba(135,188,155,1)"},"line":{"color":"rgba(135,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.7444444444444436,9.3450000000000006,10.1],"mode":"lines+markers","type":"scatter","name":"Arizona","marker":{"color":"rgba(161,182,146,1)","line":{"color":"rgba(161,182,146,1)"}},"textfont":{"color":"rgba(161,182,146,1)"},"error_y":{"color":"rgba(161,182,146,1)"},"error_x":{"color":"rgba(161,182,146,1)"},"line":{"color":"rgba(161,182,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.1111111111111107,8.5649999999999995,8.2249999999999996],"mode":"lines+markers","type":"scatter","name":"Arkansas","marker":{"color":"rgba(182,175,137,1)","line":{"color":"rgba(182,175,137,1)"}},"textfont":{"color":"rgba(182,175,137,1)"},"error_y":{"color":"rgba(182,175,137,1)"},"error_x":{"color":"rgba(182,175,137,1)"},"line":{"color":"rgba(182,175,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.199999999999999,10.720000000000001,11.800000000000001],"mode":"lines+markers","type":"scatter","name":"California","marker":{"color":"rgba(201,168,127,1)","line":{"color":"rgba(201,168,127,1)"}},"textfont":{"color":"rgba(201,168,127,1)"},"error_y":{"color":"rgba(201,168,127,1)"},"error_x":{"color":"rgba(201,168,127,1)"},"line":{"color":"rgba(201,168,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.1,12.539999999999999,12.525],"mode":"lines+markers","type":"scatter","name":"Colorado","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"line":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[12.766666666666667,12.73,13.925000000000001],"mode":"lines+markers","type":"scatter","name":"Connecticut","marker":{"color":"rgba(235,152,109,1)","line":{"color":"rgba(235,152,109,1)"}},"textfont":{"color":"rgba(235,152,109,1)"},"error_y":{"color":"rgba(235,152,109,1)"},"error_x":{"color":"rgba(235,152,109,1)"},"line":{"color":"rgba(235,152,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.088888888888889,9.9900000000000002,12.75],"mode":"lines+markers","type":"scatter","name":"Delaware","marker":{"color":"rgba(250,142,99,1)","line":{"color":"rgba(250,142,99,1)"}},"textfont":{"color":"rgba(250,142,99,1)"},"error_y":{"color":"rgba(250,142,99,1)"},"error_x":{"color":"rgba(250,142,99,1)"},"line":{"color":"rgba(250,142,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[16.699999999999999,18.515000000000001,19.024999999999999],"mode":"lines+markers","type":"scatter","name":"District of Columbia","marker":{"color":"rgba(242,144,111,1)","line":{"color":"rgba(242,144,111,1)"}},"textfont":{"color":"rgba(242,144,111,1)"},"error_y":{"color":"rgba(242,144,111,1)"},"error_x":{"color":"rgba(242,144,111,1)"},"line":{"color":"rgba(242,144,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.1333333333333329,8.3100000000000005,8.2750000000000004],"mode":"lines+markers","type":"scatter","name":"Florida","marker":{"color":"rgba(230,147,126,1)","line":{"color":"rgba(230,147,126,1)"}},"textfont":{"color":"rgba(230,147,126,1)"},"error_y":{"color":"rgba(230,147,126,1)"},"error_x":{"color":"rgba(230,147,126,1)"},"line":{"color":"rgba(230,147,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.3222222222222229,9.0350000000000001,9.6500000000000004],"mode":"lines+markers","type":"scatter","name":"Georgia","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"line":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.9333333333333336,9.0850000000000009,10.1],"mode":"lines+markers","type":"scatter","name":"Hawaii","marker":{"color":"rgba(203,152,155,1)","line":{"color":"rgba(203,152,155,1)"}},"textfont":{"color":"rgba(203,152,155,1)"},"error_y":{"color":"rgba(203,152,155,1)"},"error_x":{"color":"rgba(203,152,155,1)"},"line":{"color":"rgba(203,152,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.1777777777777771,9.6850000000000005,10.375],"mode":"lines+markers","type":"scatter","name":"Idaho","marker":{"color":"rgba(187,155,170,1)","line":{"color":"rgba(187,155,170,1)"}},"textfont":{"color":"rgba(187,155,170,1)"},"error_y":{"color":"rgba(187,155,170,1)"},"error_x":{"color":"rgba(187,155,170,1)"},"line":{"color":"rgba(187,155,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.7444444444444454,10.84,11.225000000000001],"mode":"lines+markers","type":"scatter","name":"Illinois","marker":{"color":"rgba(169,157,184,1)","line":{"color":"rgba(169,157,184,1)"}},"textfont":{"color":"rgba(169,157,184,1)"},"error_y":{"color":"rgba(169,157,184,1)"},"error_x":{"color":"rgba(169,157,184,1)"},"line":{"color":"rgba(169,157,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.9000000000000004,9.2850000000000001,10.324999999999999],"mode":"lines+markers","type":"scatter","name":"Indiana","marker":{"color":"rgba(148,159,199,1)","line":{"color":"rgba(148,159,199,1)"}},"textfont":{"color":"rgba(148,159,199,1)"},"error_y":{"color":"rgba(148,159,199,1)"},"error_x":{"color":"rgba(148,159,199,1)"},"line":{"color":"rgba(148,159,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.7666666666666657,9.8599999999999994,9.6500000000000004],"mode":"lines+markers","type":"scatter","name":"Iowa","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"line":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.7666666666666675,9.2400000000000002,10.75],"mode":"lines+markers","type":"scatter","name":"Kansas","marker":{"color":"rgba(166,156,201,1)","line":{"color":"rgba(166,156,201,1)"}},"textfont":{"color":"rgba(166,156,201,1)"},"error_y":{"color":"rgba(166,156,201,1)"},"error_x":{"color":"rgba(166,156,201,1)"},"line":{"color":"rgba(166,156,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.3111111111111118,9.4849999999999994,10.5],"mode":"lines+markers","type":"scatter","name":"Kentucky","marker":{"color":"rgba(179,153,200,1)","line":{"color":"rgba(179,153,200,1)"}},"textfont":{"color":"rgba(179,153,200,1)"},"error_y":{"color":"rgba(179,153,200,1)"},"error_x":{"color":"rgba(179,153,200,1)"},"line":{"color":"rgba(179,153,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.6333333333333329,9.3249999999999993,10],"mode":"lines+markers","type":"scatter","name":"Louisiana","marker":{"color":"rgba(192,150,199,1)","line":{"color":"rgba(192,150,199,1)"}},"textfont":{"color":"rgba(192,150,199,1)"},"error_y":{"color":"rgba(192,150,199,1)"},"error_x":{"color":"rgba(192,150,199,1)"},"line":{"color":"rgba(192,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.455555555555556,12.220000000000001,12.525],"mode":"lines+markers","type":"scatter","name":"Maine","marker":{"color":"rgba(204,147,198,1)","line":{"color":"rgba(204,147,198,1)"}},"textfont":{"color":"rgba(204,147,198,1)"},"error_y":{"color":"rgba(204,147,198,1)"},"error_x":{"color":"rgba(204,147,198,1)"},"line":{"color":"rgba(204,147,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.444444444444445,12.455,12.6],"mode":"lines+markers","type":"scatter","name":"Maryland","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[14.255555555555555,14.9,16.574999999999999],"mode":"lines+markers","type":"scatter","name":"Massachusetts","marker":{"color":"rgba(226,140,195,1)","line":{"color":"rgba(226,140,195,1)"}},"textfont":{"color":"rgba(226,140,195,1)"},"error_y":{"color":"rgba(226,140,195,1)"},"error_x":{"color":"rgba(226,140,195,1)"},"line":{"color":"rgba(226,140,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.0888888888888886,10.879999999999999,10.800000000000001],"mode":"lines+markers","type":"scatter","name":"Michigan","marker":{"color":"rgba(228,146,187,1)","line":{"color":"rgba(228,146,187,1)"}},"textfont":{"color":"rgba(228,146,187,1)"},"error_y":{"color":"rgba(228,146,187,1)"},"error_x":{"color":"rgba(228,146,187,1)"},"line":{"color":"rgba(228,146,187,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.122222222222222,10.925000000000001,12.275],"mode":"lines+markers","type":"scatter","name":"Minnesota","marker":{"color":"rgba(221,158,173,1)","line":{"color":"rgba(221,158,173,1)"}},"textfont":{"color":"rgba(221,158,173,1)"},"error_y":{"color":"rgba(221,158,173,1)"},"error_x":{"color":"rgba(221,158,173,1)"},"line":{"color":"rgba(221,158,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[6.8555555555555552,7.46,7.5749999999999993],"mode":"lines+markers","type":"scatter","name":"Mississippi","marker":{"color":"rgba(214,170,159,1)","line":{"color":"rgba(214,170,159,1)"}},"textfont":{"color":"rgba(214,170,159,1)"},"error_y":{"color":"rgba(214,170,159,1)"},"error_x":{"color":"rgba(214,170,159,1)"},"line":{"color":"rgba(214,170,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.4111111111111114,9.4550000000000001,8.875],"mode":"lines+markers","type":"scatter","name":"Missouri","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.4555555555555557,10.175000000000001,12.15],"mode":"lines+markers","type":"scatter","name":"Montana","marker":{"color":"rgba(196,191,129,1)","line":{"color":"rgba(196,191,129,1)"}},"textfont":{"color":"rgba(196,191,129,1)"},"error_y":{"color":"rgba(196,191,129,1)"},"error_x":{"color":"rgba(196,191,129,1)"},"line":{"color":"rgba(196,191,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.7555555555555555,9.7300000000000004,12.125],"mode":"lines+markers","type":"scatter","name":"Nebraska","marker":{"color":"rgba(186,201,113,1)","line":{"color":"rgba(186,201,113,1)"}},"textfont":{"color":"rgba(186,201,113,1)"},"error_y":{"color":"rgba(186,201,113,1)"},"error_x":{"color":"rgba(186,201,113,1)"},"line":{"color":"rgba(186,201,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8,8.5099999999999998,9.2249999999999996],"mode":"lines+markers","type":"scatter","name":"Nevada","marker":{"color":"rgba(174,211,95,1)","line":{"color":"rgba(174,211,95,1)"}},"textfont":{"color":"rgba(174,211,95,1)"},"error_y":{"color":"rgba(174,211,95,1)"},"error_x":{"color":"rgba(174,211,95,1)"},"line":{"color":"rgba(174,211,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.333333333333334,10.994999999999999,10.925000000000001],"mode":"lines+markers","type":"scatter","name":"New Hampshire","marker":{"color":"rgba(172,216,82,1)","line":{"color":"rgba(172,216,82,1)"}},"textfont":{"color":"rgba(172,216,82,1)"},"error_y":{"color":"rgba(172,216,82,1)"},"error_x":{"color":"rgba(172,216,82,1)"},"line":{"color":"rgba(172,216,82,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.5555555555555554,10.18,11.975],"mode":"lines+markers","type":"scatter","name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.955555555555556,10.57,12.550000000000001],"mode":"lines+markers","type":"scatter","name":"New Mexico","marker":{"color":"rgba(198,217,73,1)","line":{"color":"rgba(198,217,73,1)"}},"textfont":{"color":"rgba(198,217,73,1)"},"error_y":{"color":"rgba(198,217,73,1)"},"error_x":{"color":"rgba(198,217,73,1)"},"line":{"color":"rgba(198,217,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.766666666666666,12.290000000000001,14.050000000000001],"mode":"lines+markers","type":"scatter","name":"New York","marker":{"color":"rgba(211,217,68,1)","line":{"color":"rgba(211,217,68,1)"}},"textfont":{"color":"rgba(211,217,68,1)"},"error_y":{"color":"rgba(211,217,68,1)"},"error_x":{"color":"rgba(211,217,68,1)"},"line":{"color":"rgba(211,217,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.0333333333333332,10.41,10.425000000000001],"mode":"lines+markers","type":"scatter","name":"North Carolina","marker":{"color":"rgba(223,217,63,1)","line":{"color":"rgba(223,217,63,1)"}},"textfont":{"color":"rgba(223,217,63,1)"},"error_y":{"color":"rgba(223,217,63,1)"},"error_x":{"color":"rgba(223,217,63,1)"},"line":{"color":"rgba(223,217,63,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[6.0777777777777775,7.9894736842105267,10],"mode":"lines+markers","type":"scatter","name":"North Dakota","marker":{"color":"rgba(235,217,58,1)","line":{"color":"rgba(235,217,58,1)"}},"textfont":{"color":"rgba(235,217,58,1)"},"error_y":{"color":"rgba(235,217,58,1)"},"error_x":{"color":"rgba(235,217,58,1)"},"line":{"color":"rgba(235,217,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.3777777777777782,9.7200000000000006,10.225],"mode":"lines+markers","type":"scatter","name":"Ohio","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"line":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.833333333333333,9.3450000000000006,10.925000000000001],"mode":"lines+markers","type":"scatter","name":"Oklahoma","marker":{"color":"rgba(254,216,53,1)","line":{"color":"rgba(254,216,53,1)"}},"textfont":{"color":"rgba(254,216,53,1)"},"error_y":{"color":"rgba(254,216,53,1)"},"error_x":{"color":"rgba(254,216,53,1)"},"line":{"color":"rgba(254,216,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[12.177777777777777,13.039999999999999,14.425000000000001],"mode":"lines+markers","type":"scatter","name":"Oregon","marker":{"color":"rgba(251,213,72,1)","line":{"color":"rgba(251,213,72,1)"}},"textfont":{"color":"rgba(251,213,72,1)"},"error_y":{"color":"rgba(251,213,72,1)"},"error_x":{"color":"rgba(251,213,72,1)"},"line":{"color":"rgba(251,213,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.5666666666666664,11.120000000000001,11.675000000000001],"mode":"lines+markers","type":"scatter","name":"Pennsylvania","marker":{"color":"rgba(248,210,88,1)","line":{"color":"rgba(248,210,88,1)"}},"textfont":{"color":"rgba(248,210,88,1)"},"error_y":{"color":"rgba(248,210,88,1)"},"error_x":{"color":"rgba(248,210,88,1)"},"line":{"color":"rgba(248,210,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[12.488888888888889,15.085000000000001,14.025],"mode":"lines+markers","type":"scatter","name":"Rhode Island","marker":{"color":"rgba(245,207,101,1)","line":{"color":"rgba(245,207,101,1)"}},"textfont":{"color":"rgba(245,207,101,1)"},"error_y":{"color":"rgba(245,207,101,1)"},"error_x":{"color":"rgba(245,207,101,1)"},"line":{"color":"rgba(245,207,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.3777777777777782,8.4849999999999994,8.5999999999999996],"mode":"lines+markers","type":"scatter","name":"South Carolina","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"line":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[6.9333333333333336,7.3250000000000002,8.4250000000000007],"mode":"lines+markers","type":"scatter","name":"South Dakota","marker":{"color":"rgba(237,201,126,1)","line":{"color":"rgba(237,201,126,1)"}},"textfont":{"color":"rgba(237,201,126,1)"},"error_y":{"color":"rgba(237,201,126,1)"},"error_x":{"color":"rgba(237,201,126,1)"},"line":{"color":"rgba(237,201,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.7444444444444436,8.6649999999999991,9.4000000000000004],"mode":"lines+markers","type":"scatter","name":"Tennessee","marker":{"color":"rgba(233,198,138,1)","line":{"color":"rgba(233,198,138,1)"}},"textfont":{"color":"rgba(233,198,138,1)"},"error_y":{"color":"rgba(233,198,138,1)"},"error_x":{"color":"rgba(233,198,138,1)"},"line":{"color":"rgba(233,198,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.4111111111111114,8.0600000000000005,9.6500000000000004],"mode":"lines+markers","type":"scatter","name":"Texas","marker":{"color":"rgba(228,196,149,1)","line":{"color":"rgba(228,196,149,1)"}},"textfont":{"color":"rgba(228,196,149,1)"},"error_y":{"color":"rgba(228,196,149,1)"},"error_x":{"color":"rgba(228,196,149,1)"},"line":{"color":"rgba(228,196,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.199999999999999,11.065,12.25],"mode":"lines+markers","type":"scatter","name":"Utah","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"line":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[13.1,13.965,13.9],"mode":"lines+markers","type":"scatter","name":"Vermont","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.166666666666666,10.175000000000001,10.85],"mode":"lines+markers","type":"scatter","name":"Virginia","marker":{"color":"rgba(208,188,162,1)","line":{"color":"rgba(208,188,162,1)"}},"textfont":{"color":"rgba(208,188,162,1)"},"error_y":{"color":"rgba(208,188,162,1)"},"error_x":{"color":"rgba(208,188,162,1)"},"line":{"color":"rgba(208,188,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.555555555555555,11.625,12.725],"mode":"lines+markers","type":"scatter","name":"Washington","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"line":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.3777777777777782,8.4149999999999991,10.275],"mode":"lines+markers","type":"scatter","name":"West Virginia","marker":{"color":"rgba(194,184,171,1)","line":{"color":"rgba(194,184,171,1)"}},"textfont":{"color":"rgba(194,184,171,1)"},"error_y":{"color":"rgba(194,184,171,1)"},"error_x":{"color":"rgba(194,184,171,1)"},"line":{"color":"rgba(194,184,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.7666666666666675,9.5150000000000006,9.9749999999999996],"mode":"lines+markers","type":"scatter","name":"Wisconsin","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"textfont":{"color":"rgba(187,181,175,1)"},"error_y":{"color":"rgba(187,181,175,1)"},"error_x":{"color":"rgba(187,181,175,1)"},"line":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.1111111111111107,8.6315789473684212,8.7750000000000004],"mode":"lines+markers","type":"scatter","name":"Wyoming","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div
id="indicator-3-took-prescription-medication-for-mental-health-andor-received-counseling-or-therapy"
class="section level3">
<h3>Indicator 3: “Took Prescription Medication for Mental Health And/Or
Received Counseling or Therapy”</h3>
<p>The third indicator we’ll look at combines the first two indicators
into one category. This can help give a snapshot of overall mental
health care need.</p>
<p>The following chunk shows the top five states with the highest mean
percentage of respondents who reported mental health medication and/or
therapy use from 2020-2022. The state with the highest percentage during
this period was West Virginia.</p>
<pre class="r"><code>state_both_top5 =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(desc(mean_value)) |&gt; 
  top_n(5) </code></pre>
<pre><code>## Selecting by mean_value</code></pre>
<pre class="r"><code>state_both_top5 |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">mean_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">West Virginia</td>
<td align="right">30.74242</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="right">29.82424</td>
</tr>
<tr class="odd">
<td align="left">Kentucky</td>
<td align="right">29.72121</td>
</tr>
<tr class="even">
<td align="left">Vermont</td>
<td align="right">29.68182</td>
</tr>
<tr class="odd">
<td align="left">Maine</td>
<td align="right">29.63333</td>
</tr>
</tbody>
</table>
<p>Let’s visualize a heat map of this indicator’s prevalence by US
state.</p>
<p>First, we’ll merge the filtered dataset with an existing US state map
dataset to assist with mapping.</p>
<pre class="r"><code>state_both =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  mutate(state = tolower(state))

usa = 
  st_as_sf(map(&quot;state&quot;, fill = TRUE, plot = FALSE))

us_both =
  merge(usa, state_both, by.x = &quot;ID&quot;, by.y = &quot;state&quot;, all.x = TRUE)</code></pre>
<p>Next, we’ll plot the data using ggplot</p>
<pre class="r"><code>heatmap_both=
ggplot(us_both)+
  geom_sf(aes(fill = mean_value), color = &quot;white&quot;, size = 0.2)+
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;red&quot;, na.value = &quot;grey50&quot;, name = &quot;Avg % medication and/or therapy use&quot;)+
  theme_minimal()+
  theme(legend.position = &quot;right&quot;,
        plot.title.position = &quot;plot&quot;)+
  labs(title = &quot;Average % using medication and/or therapy 2020-2022, by state&quot;)

print(heatmap_both)</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-19-1.png" width="90%" /></p>
<p>We can also look at which states have had the greatest change in
mental health care use. This shows that WV had the highest level of
change in this indicator between 2020-2022. This makes sense, as WV had
the highest change in medication use.</p>
<pre class="r"><code>state_both_change =
  state_df |&gt; 
  filter(indicator == &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy&quot;, year != &quot;2021&quot;) |&gt; 
  group_by(state, year) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(state, year) |&gt; 
  mutate(val_change = c(NA, diff(mean_value)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>state_both_change |&gt; 
  filter(!is.na(val_change)) |&gt; 
  ungroup() |&gt; 
  select(-year, -mean_value) |&gt; 
  slice_max(order_by = val_change, n=5) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">val_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">West Virginia</td>
<td align="right">7.155556</td>
</tr>
<tr class="even">
<td align="left">North Dakota</td>
<td align="right">6.500000</td>
</tr>
<tr class="odd">
<td align="left">Nebraska</td>
<td align="right">5.747222</td>
</tr>
<tr class="even">
<td align="left">Minnesota</td>
<td align="right">4.850000</td>
</tr>
<tr class="odd">
<td align="left">Oklahoma</td>
<td align="right">4.736111</td>
</tr>
</tbody>
</table>
<p>Let’s take a look at the trend for this indicator over time.</p>
<pre class="r"><code>state_df |&gt;
  filter(indicator == &quot;Took Prescription Medication for Mental Health And/Or Received Counseling or Therapy&quot;) |&gt; 
  group_by(state, year) |&gt;
  summarize(mean_value = mean(value)) |&gt; 
  mutate(year = factor(year)) |&gt; 
plot_ly(x = ~year, y = ~mean_value, color = ~state, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;) |&gt;
  layout(
    title = &quot;% medication and/or therapy use by state &amp; year&quot;,
    xaxis = list(title = &quot;Year&quot;),
    yaxis = list(title = &quot;Average % medication and/or therapy use&quot;))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-4ab5c5b32485396c1c09" style="width:90%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-4ab5c5b32485396c1c09">{"x":{"visdat":{"2f166e6b3261":["function () ","plotlyVisDat"]},"cur_data":"2f166e6b3261","attrs":{"2f166e6b3261":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"% medication and/or therapy use by state & year","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2020","2021","2022"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Average % medication and/or therapy use"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2020","2021","2022"],"y":[26.555555555555557,26.995000000000001,29.649999999999999],"mode":"lines+markers","type":"scatter","name":"Alabama","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.011111111111113,22.625,23.375],"mode":"lines+markers","type":"scatter","name":"Alaska","marker":{"color":"rgba(135,188,155,1)","line":{"color":"rgba(135,188,155,1)"}},"textfont":{"color":"rgba(135,188,155,1)"},"error_y":{"color":"rgba(135,188,155,1)"},"error_x":{"color":"rgba(135,188,155,1)"},"line":{"color":"rgba(135,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.066666666666666,23.420000000000002,22.975000000000001],"mode":"lines+markers","type":"scatter","name":"Arizona","marker":{"color":"rgba(161,182,146,1)","line":{"color":"rgba(161,182,146,1)"}},"textfont":{"color":"rgba(161,182,146,1)"},"error_y":{"color":"rgba(161,182,146,1)"},"error_x":{"color":"rgba(161,182,146,1)"},"line":{"color":"rgba(161,182,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[27.266666666666666,28.995000000000001,30.5],"mode":"lines+markers","type":"scatter","name":"Arkansas","marker":{"color":"rgba(182,175,137,1)","line":{"color":"rgba(182,175,137,1)"}},"textfont":{"color":"rgba(182,175,137,1)"},"error_y":{"color":"rgba(182,175,137,1)"},"error_x":{"color":"rgba(182,175,137,1)"},"line":{"color":"rgba(182,175,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.022222222222222,21.114999999999998,22.674999999999997],"mode":"lines+markers","type":"scatter","name":"California","marker":{"color":"rgba(201,168,127,1)","line":{"color":"rgba(201,168,127,1)"}},"textfont":{"color":"rgba(201,168,127,1)"},"error_y":{"color":"rgba(201,168,127,1)"},"error_x":{"color":"rgba(201,168,127,1)"},"line":{"color":"rgba(201,168,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.944444444444443,27.140000000000001,26.824999999999999],"mode":"lines+markers","type":"scatter","name":"Colorado","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"line":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.166666666666668,25.760000000000002,28.449999999999999],"mode":"lines+markers","type":"scatter","name":"Connecticut","marker":{"color":"rgba(235,152,109,1)","line":{"color":"rgba(235,152,109,1)"}},"textfont":{"color":"rgba(235,152,109,1)"},"error_y":{"color":"rgba(235,152,109,1)"},"error_x":{"color":"rgba(235,152,109,1)"},"line":{"color":"rgba(235,152,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.777777777777779,24.43,25.75],"mode":"lines+markers","type":"scatter","name":"Delaware","marker":{"color":"rgba(250,142,99,1)","line":{"color":"rgba(250,142,99,1)"}},"textfont":{"color":"rgba(250,142,99,1)"},"error_y":{"color":"rgba(250,142,99,1)"},"error_x":{"color":"rgba(250,142,99,1)"},"line":{"color":"rgba(250,142,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.644444444444446,28.425000000000001,28.050000000000001],"mode":"lines+markers","type":"scatter","name":"District of Columbia","marker":{"color":"rgba(242,144,111,1)","line":{"color":"rgba(242,144,111,1)"}},"textfont":{"color":"rgba(242,144,111,1)"},"error_y":{"color":"rgba(242,144,111,1)"},"error_x":{"color":"rgba(242,144,111,1)"},"line":{"color":"rgba(242,144,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.555555555555557,22.34,23.850000000000001],"mode":"lines+markers","type":"scatter","name":"Florida","marker":{"color":"rgba(230,147,126,1)","line":{"color":"rgba(230,147,126,1)"}},"textfont":{"color":"rgba(230,147,126,1)"},"error_y":{"color":"rgba(230,147,126,1)"},"error_x":{"color":"rgba(230,147,126,1)"},"line":{"color":"rgba(230,147,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.68888888888889,24.210000000000001,23.625],"mode":"lines+markers","type":"scatter","name":"Georgia","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"line":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[15.655555555555557,17.25,18.200000000000003],"mode":"lines+markers","type":"scatter","name":"Hawaii","marker":{"color":"rgba(203,152,155,1)","line":{"color":"rgba(203,152,155,1)"}},"textfont":{"color":"rgba(203,152,155,1)"},"error_y":{"color":"rgba(203,152,155,1)"},"error_x":{"color":"rgba(203,152,155,1)"},"line":{"color":"rgba(203,152,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.955555555555556,27.25,26.75],"mode":"lines+markers","type":"scatter","name":"Idaho","marker":{"color":"rgba(187,155,170,1)","line":{"color":"rgba(187,155,170,1)"}},"textfont":{"color":"rgba(187,155,170,1)"},"error_y":{"color":"rgba(187,155,170,1)"},"error_x":{"color":"rgba(187,155,170,1)"},"line":{"color":"rgba(187,155,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.199999999999999,25.085000000000001,25.949999999999999],"mode":"lines+markers","type":"scatter","name":"Illinois","marker":{"color":"rgba(169,157,184,1)","line":{"color":"rgba(169,157,184,1)"}},"textfont":{"color":"rgba(169,157,184,1)"},"error_y":{"color":"rgba(169,157,184,1)"},"error_x":{"color":"rgba(169,157,184,1)"},"line":{"color":"rgba(169,157,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.977777777777778,28.34,30.225000000000001],"mode":"lines+markers","type":"scatter","name":"Indiana","marker":{"color":"rgba(148,159,199,1)","line":{"color":"rgba(148,159,199,1)"}},"textfont":{"color":"rgba(148,159,199,1)"},"error_y":{"color":"rgba(148,159,199,1)"},"error_x":{"color":"rgba(148,159,199,1)"},"line":{"color":"rgba(148,159,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.355555555555554,28.27,29.375],"mode":"lines+markers","type":"scatter","name":"Iowa","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"line":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.866666666666667,26.899999999999999,29.975000000000001],"mode":"lines+markers","type":"scatter","name":"Kansas","marker":{"color":"rgba(166,156,201,1)","line":{"color":"rgba(166,156,201,1)"}},"textfont":{"color":"rgba(166,156,201,1)"},"error_y":{"color":"rgba(166,156,201,1)"},"error_x":{"color":"rgba(166,156,201,1)"},"line":{"color":"rgba(166,156,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[28.033333333333331,29.984999999999999,32.200000000000003],"mode":"lines+markers","type":"scatter","name":"Kentucky","marker":{"color":"rgba(179,153,200,1)","line":{"color":"rgba(179,153,200,1)"}},"textfont":{"color":"rgba(179,153,200,1)"},"error_y":{"color":"rgba(179,153,200,1)"},"error_x":{"color":"rgba(179,153,200,1)"},"line":{"color":"rgba(179,153,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.988888888888887,28.355,28.524999999999999],"mode":"lines+markers","type":"scatter","name":"Louisiana","marker":{"color":"rgba(192,150,199,1)","line":{"color":"rgba(192,150,199,1)"}},"textfont":{"color":"rgba(192,150,199,1)"},"error_y":{"color":"rgba(192,150,199,1)"},"error_x":{"color":"rgba(192,150,199,1)"},"line":{"color":"rgba(192,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[27.988888888888887,29.815000000000001,32.424999999999997],"mode":"lines+markers","type":"scatter","name":"Maine","marker":{"color":"rgba(204,147,198,1)","line":{"color":"rgba(204,147,198,1)"}},"textfont":{"color":"rgba(204,147,198,1)"},"error_y":{"color":"rgba(204,147,198,1)"},"error_x":{"color":"rgba(204,147,198,1)"},"line":{"color":"rgba(204,147,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.099999999999998,25.215,26.125],"mode":"lines+markers","type":"scatter","name":"Maryland","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[28,28.640000000000001,30.100000000000001],"mode":"lines+markers","type":"scatter","name":"Massachusetts","marker":{"color":"rgba(226,140,195,1)","line":{"color":"rgba(226,140,195,1)"}},"textfont":{"color":"rgba(226,140,195,1)"},"error_y":{"color":"rgba(226,140,195,1)"},"error_x":{"color":"rgba(226,140,195,1)"},"line":{"color":"rgba(226,140,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.388888888888889,26.460000000000001,28.300000000000001],"mode":"lines+markers","type":"scatter","name":"Michigan","marker":{"color":"rgba(228,146,187,1)","line":{"color":"rgba(228,146,187,1)"}},"textfont":{"color":"rgba(228,146,187,1)"},"error_y":{"color":"rgba(228,146,187,1)"},"error_x":{"color":"rgba(228,146,187,1)"},"line":{"color":"rgba(228,146,187,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.800000000000001,27.719999999999999,30.649999999999999],"mode":"lines+markers","type":"scatter","name":"Minnesota","marker":{"color":"rgba(221,158,173,1)","line":{"color":"rgba(221,158,173,1)"}},"textfont":{"color":"rgba(221,158,173,1)"},"error_y":{"color":"rgba(221,158,173,1)"},"error_x":{"color":"rgba(221,158,173,1)"},"line":{"color":"rgba(221,158,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.055555555555557,25.835000000000001,24.899999999999999],"mode":"lines+markers","type":"scatter","name":"Mississippi","marker":{"color":"rgba(214,170,159,1)","line":{"color":"rgba(214,170,159,1)"}},"textfont":{"color":"rgba(214,170,159,1)"},"error_y":{"color":"rgba(214,170,159,1)"},"error_x":{"color":"rgba(214,170,159,1)"},"line":{"color":"rgba(214,170,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.199999999999999,27.850000000000001,28.274999999999999],"mode":"lines+markers","type":"scatter","name":"Missouri","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.68888888888889,26.010000000000002,26.524999999999999],"mode":"lines+markers","type":"scatter","name":"Montana","marker":{"color":"rgba(196,191,129,1)","line":{"color":"rgba(196,191,129,1)"}},"textfont":{"color":"rgba(196,191,129,1)"},"error_y":{"color":"rgba(196,191,129,1)"},"error_x":{"color":"rgba(196,191,129,1)"},"line":{"color":"rgba(196,191,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.477777777777778,26.385000000000002,30.225000000000001],"mode":"lines+markers","type":"scatter","name":"Nebraska","marker":{"color":"rgba(186,201,113,1)","line":{"color":"rgba(186,201,113,1)"}},"textfont":{"color":"rgba(186,201,113,1)"},"error_y":{"color":"rgba(186,201,113,1)"},"error_x":{"color":"rgba(186,201,113,1)"},"line":{"color":"rgba(186,201,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[19.899999999999999,20.635000000000002,20.875],"mode":"lines+markers","type":"scatter","name":"Nevada","marker":{"color":"rgba(174,211,95,1)","line":{"color":"rgba(174,211,95,1)"}},"textfont":{"color":"rgba(174,211,95,1)"},"error_y":{"color":"rgba(174,211,95,1)"},"error_x":{"color":"rgba(174,211,95,1)"},"line":{"color":"rgba(174,211,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[27.144444444444446,27.355,29.050000000000001],"mode":"lines+markers","type":"scatter","name":"New Hampshire","marker":{"color":"rgba(172,216,82,1)","line":{"color":"rgba(172,216,82,1)"}},"textfont":{"color":"rgba(172,216,82,1)"},"error_y":{"color":"rgba(172,216,82,1)"},"error_x":{"color":"rgba(172,216,82,1)"},"line":{"color":"rgba(172,216,82,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.622222222222224,21.765000000000001,23.899999999999999],"mode":"lines+markers","type":"scatter","name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.5,24.625,25.5],"mode":"lines+markers","type":"scatter","name":"New Mexico","marker":{"color":"rgba(198,217,73,1)","line":{"color":"rgba(198,217,73,1)"}},"textfont":{"color":"rgba(198,217,73,1)"},"error_y":{"color":"rgba(198,217,73,1)"},"error_x":{"color":"rgba(198,217,73,1)"},"line":{"color":"rgba(198,217,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.699999999999999,23.530000000000001,25.475000000000001],"mode":"lines+markers","type":"scatter","name":"New York","marker":{"color":"rgba(211,217,68,1)","line":{"color":"rgba(211,217,68,1)"}},"textfont":{"color":"rgba(211,217,68,1)"},"error_y":{"color":"rgba(211,217,68,1)"},"error_x":{"color":"rgba(211,217,68,1)"},"line":{"color":"rgba(211,217,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.366666666666667,27.489999999999998,26.899999999999999],"mode":"lines+markers","type":"scatter","name":"North Carolina","marker":{"color":"rgba(223,217,63,1)","line":{"color":"rgba(223,217,63,1)"}},"textfont":{"color":"rgba(223,217,63,1)"},"error_y":{"color":"rgba(223,217,63,1)"},"error_x":{"color":"rgba(223,217,63,1)"},"line":{"color":"rgba(223,217,63,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.900000000000002,25.925000000000001,28.399999999999999],"mode":"lines+markers","type":"scatter","name":"North Dakota","marker":{"color":"rgba(235,217,58,1)","line":{"color":"rgba(235,217,58,1)"}},"textfont":{"color":"rgba(235,217,58,1)"},"error_y":{"color":"rgba(235,217,58,1)"},"error_x":{"color":"rgba(235,217,58,1)"},"line":{"color":"rgba(235,217,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.088888888888889,26.844999999999999,28.699999999999999],"mode":"lines+markers","type":"scatter","name":"Ohio","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"line":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.388888888888889,28.585000000000001,31.125],"mode":"lines+markers","type":"scatter","name":"Oklahoma","marker":{"color":"rgba(254,216,53,1)","line":{"color":"rgba(254,216,53,1)"}},"textfont":{"color":"rgba(254,216,53,1)"},"error_y":{"color":"rgba(254,216,53,1)"},"error_x":{"color":"rgba(254,216,53,1)"},"line":{"color":"rgba(254,216,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[26.622222222222224,29.140000000000001,30.5],"mode":"lines+markers","type":"scatter","name":"Oregon","marker":{"color":"rgba(251,213,72,1)","line":{"color":"rgba(251,213,72,1)"}},"textfont":{"color":"rgba(251,213,72,1)"},"error_y":{"color":"rgba(251,213,72,1)"},"error_x":{"color":"rgba(251,213,72,1)"},"line":{"color":"rgba(251,213,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.322222222222223,28.004999999999999,29.524999999999999],"mode":"lines+markers","type":"scatter","name":"Pennsylvania","marker":{"color":"rgba(248,210,88,1)","line":{"color":"rgba(248,210,88,1)"}},"textfont":{"color":"rgba(248,210,88,1)"},"error_y":{"color":"rgba(248,210,88,1)"},"error_x":{"color":"rgba(248,210,88,1)"},"line":{"color":"rgba(248,210,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[27.622222222222224,30.219999999999999,29.625],"mode":"lines+markers","type":"scatter","name":"Rhode Island","marker":{"color":"rgba(245,207,101,1)","line":{"color":"rgba(245,207,101,1)"}},"textfont":{"color":"rgba(245,207,101,1)"},"error_y":{"color":"rgba(245,207,101,1)"},"error_x":{"color":"rgba(245,207,101,1)"},"line":{"color":"rgba(245,207,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.477777777777778,26.335000000000001,27.074999999999999],"mode":"lines+markers","type":"scatter","name":"South Carolina","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"line":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[22.877777777777776,24.035,26.600000000000001],"mode":"lines+markers","type":"scatter","name":"South Dakota","marker":{"color":"rgba(237,201,126,1)","line":{"color":"rgba(237,201,126,1)"}},"textfont":{"color":"rgba(237,201,126,1)"},"error_y":{"color":"rgba(237,201,126,1)"},"error_x":{"color":"rgba(237,201,126,1)"},"line":{"color":"rgba(237,201,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.077777777777779,27.245000000000001,27.450000000000003],"mode":"lines+markers","type":"scatter","name":"Tennessee","marker":{"color":"rgba(233,198,138,1)","line":{"color":"rgba(233,198,138,1)"}},"textfont":{"color":"rgba(233,198,138,1)"},"error_y":{"color":"rgba(233,198,138,1)"},"error_x":{"color":"rgba(233,198,138,1)"},"line":{"color":"rgba(233,198,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[21.488888888888887,21.855,23.925000000000001],"mode":"lines+markers","type":"scatter","name":"Texas","marker":{"color":"rgba(228,196,149,1)","line":{"color":"rgba(228,196,149,1)"}},"textfont":{"color":"rgba(228,196,149,1)"},"error_y":{"color":"rgba(228,196,149,1)"},"error_x":{"color":"rgba(228,196,149,1)"},"line":{"color":"rgba(228,196,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[28.366666666666667,30.050000000000001,31.975000000000001],"mode":"lines+markers","type":"scatter","name":"Utah","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"line":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[28.288888888888891,30.344999999999999,29.5],"mode":"lines+markers","type":"scatter","name":"Vermont","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.800000000000001,24.754999999999999,27.100000000000001],"mode":"lines+markers","type":"scatter","name":"Virginia","marker":{"color":"rgba(208,188,162,1)","line":{"color":"rgba(208,188,162,1)"}},"textfont":{"color":"rgba(208,188,162,1)"},"error_y":{"color":"rgba(208,188,162,1)"},"error_x":{"color":"rgba(208,188,162,1)"},"line":{"color":"rgba(208,188,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[25.566666666666666,26.690000000000001,27.700000000000003],"mode":"lines+markers","type":"scatter","name":"Washington","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"line":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[29.144444444444442,30.350000000000001,36.299999999999997],"mode":"lines+markers","type":"scatter","name":"West Virginia","marker":{"color":"rgba(194,184,171,1)","line":{"color":"rgba(194,184,171,1)"}},"textfont":{"color":"rgba(194,184,171,1)"},"error_y":{"color":"rgba(194,184,171,1)"},"error_x":{"color":"rgba(194,184,171,1)"},"line":{"color":"rgba(194,184,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[24.244444444444444,25.760000000000002,28.5],"mode":"lines+markers","type":"scatter","name":"Wisconsin","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"textfont":{"color":"rgba(187,181,175,1)"},"error_y":{"color":"rgba(187,181,175,1)"},"error_x":{"color":"rgba(187,181,175,1)"},"line":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[23.788888888888888,23.504999999999999,23.449999999999999],"mode":"lines+markers","type":"scatter","name":"Wyoming","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="indicator-4-needed-counseling-or-therapy-but-did-not-get-it"
class="section level3">
<h3>Indicator 4: Needed Counseling or Therapy But Did Not Get It</h3>
<p>The last indicator we’ll look at is describes gaps in mental health
care access, specifically counseling and therapy.</p>
<p>The following chunk shows the top five states with the highest mean
percentage of respondents who reported no receipt of needed
counseling/therapy from 2020-2022. The state with the highest percentage
during this period was Oregon. Surprisingly, District of Columbia also
appeared on the top 5, even though it was the “state” with the highest
level of therapy use during this period.</p>
<pre class="r"><code>state_need_top5 =
  state_df |&gt; 
  filter(indicator == &quot;Needed Counseling or Therapy But Did Not Get It&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(desc(mean_value)) |&gt; 
  top_n(5) </code></pre>
<pre><code>## Selecting by mean_value</code></pre>
<pre class="r"><code>state_need_top5 |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">mean_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Oregon</td>
<td align="right">14.43939</td>
</tr>
<tr class="even">
<td align="left">Utah</td>
<td align="right">13.77879</td>
</tr>
<tr class="odd">
<td align="left">District of Columbia</td>
<td align="right">13.67273</td>
</tr>
<tr class="even">
<td align="left">Colorado</td>
<td align="right">13.02727</td>
</tr>
<tr class="odd">
<td align="left">Washington</td>
<td align="right">12.89697</td>
</tr>
</tbody>
</table>
<p>Let’s visualize a heat map of this indicator’s prevalence by US
state.</p>
<p>First, we’ll merge the filtered dataset with an existing US state map
dataset to assist with mapping.</p>
<pre class="r"><code>state_need =
  state_df |&gt; 
  filter(indicator == &quot;Needed Counseling or Therapy But Did Not Get It&quot;) |&gt; 
  group_by(state) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  mutate(state = tolower(state))

usa = 
  st_as_sf(map(&quot;state&quot;, fill = TRUE, plot = FALSE))

us_need =
  merge(usa, state_need, by.x = &quot;ID&quot;, by.y = &quot;state&quot;, all.x = TRUE)</code></pre>
<p>Next, we’ll plot the data using ggplot</p>
<pre class="r"><code>heatmap_need=
ggplot(us_need)+
  geom_sf(aes(fill = mean_value), color = &quot;white&quot;, size = 0.2)+
  scale_fill_gradient(low = &quot;white&quot;, high = &quot;red&quot;, na.value = &quot;grey50&quot;, name = &quot;Avg % did not receive needed therapy&quot;)+
  theme_minimal()+
  theme(legend.position = &quot;right&quot;,
        plot.title.position = &quot;plot&quot;)+
  labs(title = &quot;Average % did not receive needed therapy 2020-2022, by state&quot;)

print(heatmap_need)</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-24-1.png" width="90%" /></p>
<p>We can also look at which states have had the greatest change in
unmet mental health care need. This shows that AK had the highest level
of change in this indicator between 2020-2022.</p>
<pre class="r"><code>state_need_change =
  state_df |&gt; 
  filter(indicator == &quot;Needed Counseling or Therapy But Did Not Get It&quot;, year != &quot;2021&quot;) |&gt; 
  group_by(state, year) |&gt; 
  summarize(mean_value = mean(value)) |&gt; 
  arrange(state, year) |&gt; 
  mutate(val_change = c(NA, diff(mean_value)))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<pre class="r"><code>state_need_change |&gt; 
  filter(!is.na(val_change)) |&gt; 
  ungroup() |&gt; 
  select(-year, -mean_value) |&gt; 
  slice_max(order_by = val_change, n=5) |&gt; 
  knitr::kable()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">state</th>
<th align="right">val_change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Arkansas</td>
<td align="right">3.127778</td>
</tr>
<tr class="even">
<td align="left">Wyoming</td>
<td align="right">2.694444</td>
</tr>
<tr class="odd">
<td align="left">South Dakota</td>
<td align="right">2.538889</td>
</tr>
<tr class="even">
<td align="left">Texas</td>
<td align="right">2.363889</td>
</tr>
<tr class="odd">
<td align="left">Wisconsin</td>
<td align="right">2.308333</td>
</tr>
</tbody>
</table>
<p>Let’s take a look at the trend for this indicator over time.</p>
<pre class="r"><code>state_df |&gt;
  filter(indicator == &quot;Needed Counseling or Therapy But Did Not Get It&quot;) |&gt; 
  group_by(state, year) |&gt;
  summarize(mean_value = mean(value)) |&gt; 
  mutate(year = factor(year)) |&gt; 
plot_ly(x = ~year, y = ~mean_value, color = ~state, type = &quot;scatter&quot;, mode = &quot;lines+markers&quot;) |&gt;
  layout(
    title = &quot;% did not receive needed therapy by state &amp; year&quot;,
    xaxis = list(title = &quot;Year&quot;),
    yaxis = list(title = &quot;Avg % did not receive needed therapy&quot;))</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;state&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-03fd5f6a70c42878f283" style="width:90%;height:576px;"></div>
<script type="application/json" data-for="htmlwidget-03fd5f6a70c42878f283">{"x":{"visdat":{"2f166f19528e":["function () ","plotlyVisDat"]},"cur_data":"2f166f19528e","attrs":{"2f166f19528e":{"x":{},"y":{},"mode":"lines+markers","color":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"% did not receive needed therapy by state & year","xaxis":{"domain":[0,1],"automargin":true,"title":"Year","type":"category","categoryorder":"array","categoryarray":["2020","2021","2022"]},"yaxis":{"domain":[0,1],"automargin":true,"title":"Avg % did not receive needed therapy"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["2020","2021","2022"],"y":[10.577777777777778,11.699999999999999,11.449999999999999],"mode":"lines+markers","type":"scatter","name":"Alabama","marker":{"color":"rgba(102,194,165,1)","line":{"color":"rgba(102,194,165,1)"}},"textfont":{"color":"rgba(102,194,165,1)"},"error_y":{"color":"rgba(102,194,165,1)"},"error_x":{"color":"rgba(102,194,165,1)"},"line":{"color":"rgba(102,194,165,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11,11.335000000000001,13.199999999999999],"mode":"lines+markers","type":"scatter","name":"Alaska","marker":{"color":"rgba(135,188,155,1)","line":{"color":"rgba(135,188,155,1)"}},"textfont":{"color":"rgba(135,188,155,1)"},"error_y":{"color":"rgba(135,188,155,1)"},"error_x":{"color":"rgba(135,188,155,1)"},"line":{"color":"rgba(135,188,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.322222222222223,11.504999999999999,11.824999999999999],"mode":"lines+markers","type":"scatter","name":"Arizona","marker":{"color":"rgba(161,182,146,1)","line":{"color":"rgba(161,182,146,1)"}},"textfont":{"color":"rgba(161,182,146,1)"},"error_y":{"color":"rgba(161,182,146,1)"},"error_x":{"color":"rgba(161,182,146,1)"},"line":{"color":"rgba(161,182,146,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.622222222222222,11.145,13.75],"mode":"lines+markers","type":"scatter","name":"Arkansas","marker":{"color":"rgba(182,175,137,1)","line":{"color":"rgba(182,175,137,1)"}},"textfont":{"color":"rgba(182,175,137,1)"},"error_y":{"color":"rgba(182,175,137,1)"},"error_x":{"color":"rgba(182,175,137,1)"},"line":{"color":"rgba(182,175,137,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[12.277777777777777,11.25,12.25],"mode":"lines+markers","type":"scatter","name":"California","marker":{"color":"rgba(201,168,127,1)","line":{"color":"rgba(201,168,127,1)"}},"textfont":{"color":"rgba(201,168,127,1)"},"error_y":{"color":"rgba(201,168,127,1)"},"error_x":{"color":"rgba(201,168,127,1)"},"line":{"color":"rgba(201,168,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[13.188888888888888,13.15,12.050000000000001],"mode":"lines+markers","type":"scatter","name":"Colorado","marker":{"color":"rgba(219,161,118,1)","line":{"color":"rgba(219,161,118,1)"}},"textfont":{"color":"rgba(219,161,118,1)"},"error_y":{"color":"rgba(219,161,118,1)"},"error_x":{"color":"rgba(219,161,118,1)"},"line":{"color":"rgba(219,161,118,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.6111111111111107,9.0350000000000001,9.4499999999999993],"mode":"lines+markers","type":"scatter","name":"Connecticut","marker":{"color":"rgba(235,152,109,1)","line":{"color":"rgba(235,152,109,1)"}},"textfont":{"color":"rgba(235,152,109,1)"},"error_y":{"color":"rgba(235,152,109,1)"},"error_x":{"color":"rgba(235,152,109,1)"},"line":{"color":"rgba(235,152,109,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.433333333333334,8.8650000000000002,8.0999999999999996],"mode":"lines+markers","type":"scatter","name":"Delaware","marker":{"color":"rgba(250,142,99,1)","line":{"color":"rgba(250,142,99,1)"}},"textfont":{"color":"rgba(250,142,99,1)"},"error_y":{"color":"rgba(250,142,99,1)"},"error_x":{"color":"rgba(250,142,99,1)"},"line":{"color":"rgba(250,142,99,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[13.566666666666666,13.404999999999999,15.25],"mode":"lines+markers","type":"scatter","name":"District of Columbia","marker":{"color":"rgba(242,144,111,1)","line":{"color":"rgba(242,144,111,1)"}},"textfont":{"color":"rgba(242,144,111,1)"},"error_y":{"color":"rgba(242,144,111,1)"},"error_x":{"color":"rgba(242,144,111,1)"},"line":{"color":"rgba(242,144,111,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.9444444444444446,10.209999999999999,10.65],"mode":"lines+markers","type":"scatter","name":"Florida","marker":{"color":"rgba(230,147,126,1)","line":{"color":"rgba(230,147,126,1)"}},"textfont":{"color":"rgba(230,147,126,1)"},"error_y":{"color":"rgba(230,147,126,1)"},"error_x":{"color":"rgba(230,147,126,1)"},"line":{"color":"rgba(230,147,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.655555555555555,12.324999999999999,12.9],"mode":"lines+markers","type":"scatter","name":"Georgia","marker":{"color":"rgba(217,150,141,1)","line":{"color":"rgba(217,150,141,1)"}},"textfont":{"color":"rgba(217,150,141,1)"},"error_y":{"color":"rgba(217,150,141,1)"},"error_x":{"color":"rgba(217,150,141,1)"},"line":{"color":"rgba(217,150,141,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.1111111111111107,7.4526315789473685,8.75],"mode":"lines+markers","type":"scatter","name":"Hawaii","marker":{"color":"rgba(203,152,155,1)","line":{"color":"rgba(203,152,155,1)"}},"textfont":{"color":"rgba(203,152,155,1)"},"error_y":{"color":"rgba(203,152,155,1)"},"error_x":{"color":"rgba(203,152,155,1)"},"line":{"color":"rgba(203,152,155,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.622222222222222,11.56,11.699999999999999],"mode":"lines+markers","type":"scatter","name":"Idaho","marker":{"color":"rgba(187,155,170,1)","line":{"color":"rgba(187,155,170,1)"}},"textfont":{"color":"rgba(187,155,170,1)"},"error_y":{"color":"rgba(187,155,170,1)"},"error_x":{"color":"rgba(187,155,170,1)"},"line":{"color":"rgba(187,155,170,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.122222222222222,10.32,11.975],"mode":"lines+markers","type":"scatter","name":"Illinois","marker":{"color":"rgba(169,157,184,1)","line":{"color":"rgba(169,157,184,1)"}},"textfont":{"color":"rgba(169,157,184,1)"},"error_y":{"color":"rgba(169,157,184,1)"},"error_x":{"color":"rgba(169,157,184,1)"},"line":{"color":"rgba(169,157,184,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.566666666666666,10.734999999999999,10.824999999999999],"mode":"lines+markers","type":"scatter","name":"Indiana","marker":{"color":"rgba(148,159,199,1)","line":{"color":"rgba(148,159,199,1)"}},"textfont":{"color":"rgba(148,159,199,1)"},"error_y":{"color":"rgba(148,159,199,1)"},"error_x":{"color":"rgba(148,159,199,1)"},"line":{"color":"rgba(148,159,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.4777777777777779,9.5600000000000005,9.3000000000000007],"mode":"lines+markers","type":"scatter","name":"Iowa","marker":{"color":"rgba(152,158,202,1)","line":{"color":"rgba(152,158,202,1)"}},"textfont":{"color":"rgba(152,158,202,1)"},"error_y":{"color":"rgba(152,158,202,1)"},"error_x":{"color":"rgba(152,158,202,1)"},"line":{"color":"rgba(152,158,202,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.955555555555556,11.135,11.925000000000001],"mode":"lines+markers","type":"scatter","name":"Kansas","marker":{"color":"rgba(166,156,201,1)","line":{"color":"rgba(166,156,201,1)"}},"textfont":{"color":"rgba(166,156,201,1)"},"error_y":{"color":"rgba(166,156,201,1)"},"error_x":{"color":"rgba(166,156,201,1)"},"line":{"color":"rgba(166,156,201,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.944444444444445,11.199999999999999,11.85],"mode":"lines+markers","type":"scatter","name":"Kentucky","marker":{"color":"rgba(179,153,200,1)","line":{"color":"rgba(179,153,200,1)"}},"textfont":{"color":"rgba(179,153,200,1)"},"error_y":{"color":"rgba(179,153,200,1)"},"error_x":{"color":"rgba(179,153,200,1)"},"line":{"color":"rgba(179,153,200,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.588888888888889,11.164999999999999,10.949999999999999],"mode":"lines+markers","type":"scatter","name":"Louisiana","marker":{"color":"rgba(192,150,199,1)","line":{"color":"rgba(192,150,199,1)"}},"textfont":{"color":"rgba(192,150,199,1)"},"error_y":{"color":"rgba(192,150,199,1)"},"error_x":{"color":"rgba(192,150,199,1)"},"line":{"color":"rgba(192,150,199,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.588888888888889,10.02,11.425000000000001],"mode":"lines+markers","type":"scatter","name":"Maine","marker":{"color":"rgba(204,147,198,1)","line":{"color":"rgba(204,147,198,1)"}},"textfont":{"color":"rgba(204,147,198,1)"},"error_y":{"color":"rgba(204,147,198,1)"},"error_x":{"color":"rgba(204,147,198,1)"},"line":{"color":"rgba(204,147,198,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.322222222222223,10.41,11.1],"mode":"lines+markers","type":"scatter","name":"Maryland","marker":{"color":"rgba(215,144,197,1)","line":{"color":"rgba(215,144,197,1)"}},"textfont":{"color":"rgba(215,144,197,1)"},"error_y":{"color":"rgba(215,144,197,1)"},"error_x":{"color":"rgba(215,144,197,1)"},"line":{"color":"rgba(215,144,197,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.111111111111111,10.045,11.4],"mode":"lines+markers","type":"scatter","name":"Massachusetts","marker":{"color":"rgba(226,140,195,1)","line":{"color":"rgba(226,140,195,1)"}},"textfont":{"color":"rgba(226,140,195,1)"},"error_y":{"color":"rgba(226,140,195,1)"},"error_x":{"color":"rgba(226,140,195,1)"},"line":{"color":"rgba(226,140,195,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.866666666666667,10.875,10.574999999999999],"mode":"lines+markers","type":"scatter","name":"Michigan","marker":{"color":"rgba(228,146,187,1)","line":{"color":"rgba(228,146,187,1)"}},"textfont":{"color":"rgba(228,146,187,1)"},"error_y":{"color":"rgba(228,146,187,1)"},"error_x":{"color":"rgba(228,146,187,1)"},"line":{"color":"rgba(228,146,187,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.6666666666666661,9.9250000000000007,10.475],"mode":"lines+markers","type":"scatter","name":"Minnesota","marker":{"color":"rgba(221,158,173,1)","line":{"color":"rgba(221,158,173,1)"}},"textfont":{"color":"rgba(221,158,173,1)"},"error_y":{"color":"rgba(221,158,173,1)"},"error_x":{"color":"rgba(221,158,173,1)"},"line":{"color":"rgba(221,158,173,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.822222222222223,10.515000000000001,11.525],"mode":"lines+markers","type":"scatter","name":"Mississippi","marker":{"color":"rgba(214,170,159,1)","line":{"color":"rgba(214,170,159,1)"}},"textfont":{"color":"rgba(214,170,159,1)"},"error_y":{"color":"rgba(214,170,159,1)"},"error_x":{"color":"rgba(214,170,159,1)"},"line":{"color":"rgba(214,170,159,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.28888888888889,12.445,11.475],"mode":"lines+markers","type":"scatter","name":"Missouri","marker":{"color":"rgba(205,180,144,1)","line":{"color":"rgba(205,180,144,1)"}},"textfont":{"color":"rgba(205,180,144,1)"},"error_y":{"color":"rgba(205,180,144,1)"},"error_x":{"color":"rgba(205,180,144,1)"},"line":{"color":"rgba(205,180,144,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.022222222222222,10.175000000000001,11.6],"mode":"lines+markers","type":"scatter","name":"Montana","marker":{"color":"rgba(196,191,129,1)","line":{"color":"rgba(196,191,129,1)"}},"textfont":{"color":"rgba(196,191,129,1)"},"error_y":{"color":"rgba(196,191,129,1)"},"error_x":{"color":"rgba(196,191,129,1)"},"line":{"color":"rgba(196,191,129,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.8888888888888893,9.9900000000000002,11.050000000000001],"mode":"lines+markers","type":"scatter","name":"Nebraska","marker":{"color":"rgba(186,201,113,1)","line":{"color":"rgba(186,201,113,1)"}},"textfont":{"color":"rgba(186,201,113,1)"},"error_y":{"color":"rgba(186,201,113,1)"},"error_x":{"color":"rgba(186,201,113,1)"},"line":{"color":"rgba(186,201,113,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.6,11.435,11.35],"mode":"lines+markers","type":"scatter","name":"Nevada","marker":{"color":"rgba(174,211,95,1)","line":{"color":"rgba(174,211,95,1)"}},"textfont":{"color":"rgba(174,211,95,1)"},"error_y":{"color":"rgba(174,211,95,1)"},"error_x":{"color":"rgba(174,211,95,1)"},"line":{"color":"rgba(174,211,95,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.0444444444444443,10.01,9.4749999999999996],"mode":"lines+markers","type":"scatter","name":"New Hampshire","marker":{"color":"rgba(172,216,82,1)","line":{"color":"rgba(172,216,82,1)"}},"textfont":{"color":"rgba(172,216,82,1)"},"error_y":{"color":"rgba(172,216,82,1)"},"error_x":{"color":"rgba(172,216,82,1)"},"line":{"color":"rgba(172,216,82,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.3555555555555561,8.9199999999999999,9.1999999999999993],"mode":"lines+markers","type":"scatter","name":"New Jersey","marker":{"color":"rgba(186,217,78,1)","line":{"color":"rgba(186,217,78,1)"}},"textfont":{"color":"rgba(186,217,78,1)"},"error_y":{"color":"rgba(186,217,78,1)"},"error_x":{"color":"rgba(186,217,78,1)"},"line":{"color":"rgba(186,217,78,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.433333333333334,11.35,12.35],"mode":"lines+markers","type":"scatter","name":"New Mexico","marker":{"color":"rgba(198,217,73,1)","line":{"color":"rgba(198,217,73,1)"}},"textfont":{"color":"rgba(198,217,73,1)"},"error_y":{"color":"rgba(198,217,73,1)"},"error_x":{"color":"rgba(198,217,73,1)"},"line":{"color":"rgba(198,217,73,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.0111111111111111,9.7400000000000002,9.5999999999999996],"mode":"lines+markers","type":"scatter","name":"New York","marker":{"color":"rgba(211,217,68,1)","line":{"color":"rgba(211,217,68,1)"}},"textfont":{"color":"rgba(211,217,68,1)"},"error_y":{"color":"rgba(211,217,68,1)"},"error_x":{"color":"rgba(211,217,68,1)"},"line":{"color":"rgba(211,217,68,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.488888888888889,10.800000000000001,10.074999999999999],"mode":"lines+markers","type":"scatter","name":"North Carolina","marker":{"color":"rgba(223,217,63,1)","line":{"color":"rgba(223,217,63,1)"}},"textfont":{"color":"rgba(223,217,63,1)"},"error_y":{"color":"rgba(223,217,63,1)"},"error_x":{"color":"rgba(223,217,63,1)"},"line":{"color":"rgba(223,217,63,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.1555555555555559,8.8894736842105253,8.8499999999999996],"mode":"lines+markers","type":"scatter","name":"North Dakota","marker":{"color":"rgba(235,217,58,1)","line":{"color":"rgba(235,217,58,1)"}},"textfont":{"color":"rgba(235,217,58,1)"},"error_y":{"color":"rgba(235,217,58,1)"},"error_x":{"color":"rgba(235,217,58,1)"},"line":{"color":"rgba(235,217,58,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.633333333333333,10.529999999999999,10.275],"mode":"lines+markers","type":"scatter","name":"Ohio","marker":{"color":"rgba(247,217,52,1)","line":{"color":"rgba(247,217,52,1)"}},"textfont":{"color":"rgba(247,217,52,1)"},"error_y":{"color":"rgba(247,217,52,1)"},"error_x":{"color":"rgba(247,217,52,1)"},"line":{"color":"rgba(247,217,52,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.877777777777778,12.584999999999999,13.550000000000001],"mode":"lines+markers","type":"scatter","name":"Oklahoma","marker":{"color":"rgba(254,216,53,1)","line":{"color":"rgba(254,216,53,1)"}},"textfont":{"color":"rgba(254,216,53,1)"},"error_y":{"color":"rgba(254,216,53,1)"},"error_x":{"color":"rgba(254,216,53,1)"},"line":{"color":"rgba(254,216,53,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[13.811111111111112,14.494999999999999,15.574999999999999],"mode":"lines+markers","type":"scatter","name":"Oregon","marker":{"color":"rgba(251,213,72,1)","line":{"color":"rgba(251,213,72,1)"}},"textfont":{"color":"rgba(251,213,72,1)"},"error_y":{"color":"rgba(251,213,72,1)"},"error_x":{"color":"rgba(251,213,72,1)"},"line":{"color":"rgba(251,213,72,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.2777777777777786,9.5600000000000005,9.5999999999999996],"mode":"lines+markers","type":"scatter","name":"Pennsylvania","marker":{"color":"rgba(248,210,88,1)","line":{"color":"rgba(248,210,88,1)"}},"textfont":{"color":"rgba(248,210,88,1)"},"error_y":{"color":"rgba(248,210,88,1)"},"error_x":{"color":"rgba(248,210,88,1)"},"line":{"color":"rgba(248,210,88,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.844444444444445,9.6649999999999991,10.15],"mode":"lines+markers","type":"scatter","name":"Rhode Island","marker":{"color":"rgba(245,207,101,1)","line":{"color":"rgba(245,207,101,1)"}},"textfont":{"color":"rgba(245,207,101,1)"},"error_y":{"color":"rgba(245,207,101,1)"},"error_x":{"color":"rgba(245,207,101,1)"},"line":{"color":"rgba(245,207,101,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.611111111111111,10.48,10.85],"mode":"lines+markers","type":"scatter","name":"South Carolina","marker":{"color":"rgba(241,204,114,1)","line":{"color":"rgba(241,204,114,1)"}},"textfont":{"color":"rgba(241,204,114,1)"},"error_y":{"color":"rgba(241,204,114,1)"},"error_x":{"color":"rgba(241,204,114,1)"},"line":{"color":"rgba(241,204,114,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[7.5111111111111111,8.3450000000000006,10.050000000000001],"mode":"lines+markers","type":"scatter","name":"South Dakota","marker":{"color":"rgba(237,201,126,1)","line":{"color":"rgba(237,201,126,1)"}},"textfont":{"color":"rgba(237,201,126,1)"},"error_y":{"color":"rgba(237,201,126,1)"},"error_x":{"color":"rgba(237,201,126,1)"},"line":{"color":"rgba(237,201,126,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.933333333333334,11,12.024999999999999],"mode":"lines+markers","type":"scatter","name":"Tennessee","marker":{"color":"rgba(233,198,138,1)","line":{"color":"rgba(233,198,138,1)"}},"textfont":{"color":"rgba(233,198,138,1)"},"error_y":{"color":"rgba(233,198,138,1)"},"error_x":{"color":"rgba(233,198,138,1)"},"line":{"color":"rgba(233,198,138,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.811111111111112,12.105,13.175000000000001],"mode":"lines+markers","type":"scatter","name":"Texas","marker":{"color":"rgba(228,196,149,1)","line":{"color":"rgba(228,196,149,1)"}},"textfont":{"color":"rgba(228,196,149,1)"},"error_y":{"color":"rgba(228,196,149,1)"},"error_x":{"color":"rgba(228,196,149,1)"},"line":{"color":"rgba(228,196,149,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[13.844444444444445,13.435,15.35],"mode":"lines+markers","type":"scatter","name":"Utah","marker":{"color":"rgba(222,193,153,1)","line":{"color":"rgba(222,193,153,1)"}},"textfont":{"color":"rgba(222,193,153,1)"},"error_y":{"color":"rgba(222,193,153,1)"},"error_x":{"color":"rgba(222,193,153,1)"},"line":{"color":"rgba(222,193,153,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.811111111111112,10.058823529411764,10.475],"mode":"lines+markers","type":"scatter","name":"Vermont","marker":{"color":"rgba(215,191,158,1)","line":{"color":"rgba(215,191,158,1)"}},"textfont":{"color":"rgba(215,191,158,1)"},"error_y":{"color":"rgba(215,191,158,1)"},"error_x":{"color":"rgba(215,191,158,1)"},"line":{"color":"rgba(215,191,158,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.022222222222222,10.234999999999999,9.9749999999999996],"mode":"lines+markers","type":"scatter","name":"Virginia","marker":{"color":"rgba(208,188,162,1)","line":{"color":"rgba(208,188,162,1)"}},"textfont":{"color":"rgba(208,188,162,1)"},"error_y":{"color":"rgba(208,188,162,1)"},"error_x":{"color":"rgba(208,188,162,1)"},"line":{"color":"rgba(208,188,162,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[11.922222222222222,13.145,13.850000000000001],"mode":"lines+markers","type":"scatter","name":"Washington","marker":{"color":"rgba(201,186,166,1)","line":{"color":"rgba(201,186,166,1)"}},"textfont":{"color":"rgba(201,186,166,1)"},"error_y":{"color":"rgba(201,186,166,1)"},"error_x":{"color":"rgba(201,186,166,1)"},"line":{"color":"rgba(201,186,166,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[10.577777777777778,10.975,9.7750000000000004],"mode":"lines+markers","type":"scatter","name":"West Virginia","marker":{"color":"rgba(194,184,171,1)","line":{"color":"rgba(194,184,171,1)"}},"textfont":{"color":"rgba(194,184,171,1)"},"error_y":{"color":"rgba(194,184,171,1)"},"error_x":{"color":"rgba(194,184,171,1)"},"line":{"color":"rgba(194,184,171,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[8.4666666666666668,9.2799999999999994,10.775],"mode":"lines+markers","type":"scatter","name":"Wisconsin","marker":{"color":"rgba(187,181,175,1)","line":{"color":"rgba(187,181,175,1)"}},"textfont":{"color":"rgba(187,181,175,1)"},"error_y":{"color":"rgba(187,181,175,1)"},"error_x":{"color":"rgba(187,181,175,1)"},"line":{"color":"rgba(187,181,175,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["2020","2021","2022"],"y":[9.0555555555555554,10.255555555555556,11.75],"mode":"lines+markers","type":"scatter","name":"Wyoming","marker":{"color":"rgba(179,179,179,1)","line":{"color":"rgba(179,179,179,1)"}},"textfont":{"color":"rgba(179,179,179,1)"},"error_y":{"color":"rgba(179,179,179,1)"},"error_x":{"color":"rgba(179,179,179,1)"},"line":{"color":"rgba(179,179,179,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<p>After analysis of the four indicators by state, we found the lowest
prevalence of mental health care use in some of the most populous US
states: California, New York, Texas, and Florida. Medication use
prevalence was highest in West Virginia, Kentucky, Arkansas, Utah, and
Oklahoma. Except for Utah, these states have high rates of <a
href="https://data.ers.usda.gov/reports.aspx?ID=17826">poverty</a> and
low [median household income] (<a
href="https://www.kff.org/other/state-indicator/median-annual-income/?activeTab=map&amp;currentTimeframe=0&amp;selectedDistributions=median-annual-household-income&amp;sortModel=%7B%22colId%22:%22Location%22,%22sort%22:%22asc%22%7D"
class="uri">https://www.kff.org/other/state-indicator/median-annual-income/?activeTab=map&amp;currentTimeframe=0&amp;selectedDistributions=median-annual-household-income&amp;sortModel=%7B%22colId%22:%22Location%22,%22sort%22:%22asc%22%7D</a>),
which could drive higher rates of mental health medication use.</p>
<p>Therapy use was highest in District of Columbia, Massachusetts, Rhode
Island, Vermont, and Oregon. These states have high levels of <a
href="https://data.ers.usda.gov/reports.aspx?ID=17829#P9452d1b2fc324fd3ba7da7fb1edf4e99_2_240iT2">educational
attainment</a> which could mean that their populations have more
positive perceptions of therapy. That said, the greatest change in
therapy use during the pandemic was in more rural states with lower
median household income, like Nebraska and North Dakota. It’s possible
that these were states that particularly benefited from expansions in
telehealth for providing therapy. When medication and therapy indicators
are combined to indicate overall mental health burden, West Virginia,
Utah, and Kentucky remain the highest, but are joined by Vermont and
Maine. Vermont, Maine, and Utah all have high median household income,
which suggests ruralness rather than income levels may drive mental
health burden at the state level.</p>
<p>Interestingly, the states with the highest prevalence of unmet
therapy needs also tended to have a higher prevalence of therapy use.
This could indicate that demand for therapy outpaced supply of mental
health care providers even with the expansion of telehealth during the
pandemic. However, West Virginia, which had a high prevalence of
medication use, did not have high unmet therapy needs. This could mean
that in certain states, medication use is not tied to therapy use.</p>
</div>
</div>
<div id="disaggregations-by-demographics" class="section level2">
<h2>Disaggregations by Demographics</h2>
<div id="age-group" class="section level3">
<h3>Age group</h3>
<p>I started by filtering the tidy dataset to only include age and
residence in the United States. Then, I renamed the “80 years and above”
subgroup to 80+ years. Afterward, I plotted the age group graph;
however, because the start_date variable overlapped, the legend was
difficult to view when I plotted the graph. As a result, I rotated the
x-axis labels vertically and stacked the legend to two columns.</p>
<pre class="r"><code>#Filtering the dataset to age and united states
age_plot &lt;- tidydata |&gt; 
  filter(group == &quot;Age&quot;, state == &quot;United States&quot;)

#Renaming the &quot;80 years and above&quot; subgroup to 80+ years
age_plot$subgroup[age_plot$subgroup == &quot;80 years and above&quot;] = &quot;80+ years&quot;

#Ploting the age group
age_plot |&gt; 
  group_by(indicator, start_dates, subgroup) |&gt;
  ggplot(aes(x = start_dates, y = value, color = indicator)) +
  geom_line() +
  facet_grid(. ~ subgroup) +
  labs(
    x = &quot;Start Date&quot;,
    y = &quot;Average Value&quot;,
    title = &quot;Differences in Indicators Among Age Groups (2021-2022)&quot;) +
  theme_gray() +
  theme(
    legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)  # Rotate x-axis labels vertically
  ) +
  scale_color_hue(h = c(100, 300)) +
  guides(color = guide_legend(nrow = 2)) # Adding the legend guide adjustment</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-27-1.png" width="90%" /></p>
<p>Critical findings:</p>
<p>Based on the graph, it is clear that among the age groups, 18-29 have
the highest values across all the indicators. Especially for the
indicator of taking prescription medication for mental health and or
receiving counseling, followed by the 30-39 age group, then 40-49 years.
Since the data is captured from 2021 to 2022 during the pandemic,
lockdown and transition to a virtual environment might cause tremendous
pressure on these age groups. In addition, limited access to social life
might burden the 18-29 age group. In addition, it is surprising to see
that age groups from 60 and above have the lowest values of needed
counseling or therapy but did not get it and received counseling or
therapy. Maybe many of them are in their retirement, or this age group
has a stigma around mental health because they might have a negative
impression about having mental health issues. Therefore, they are less
likely to admit they need counseling or therapy.</p>
</div>
<div id="education-level" class="section level3">
<h3>Education level</h3>
<p>I began by filtering the tidy dataset to only age and participants
residing in the United States. In the next step, I re-leveled the
education subgroup by creating a new variable, ed_name. Afterward, I
used the new variable, ed_name, to create an education plot. Similar to
the age plot, the x-axis labels and legend are difficult to view. So, I
adjusted the x-axis labels to vertical and stacked the legend columns
into two columns.</p>
<pre class="r"><code>#Filtering the dataset to age and united states, re-level the subgroup, and plot the education plot 
ed_plot= 
  tidydata |&gt;
  filter(group == &quot;Education&quot;, state == &quot;United States&quot;) |&gt; 
   mutate(ed_name = forcats::fct_relevel(subgroup, c(&quot;Bachelor&#39;s degree or higher&quot;,
                                                     &quot;Some college/Associate&#39;s degree&quot;, &quot;High school diploma or GED&quot;, &quot;Less than a high school diploma&quot;))) |&gt; 
  group_by(start_dates, ed_name, indicator) |&gt; 
  ggplot(aes(x = start_dates, y = value, color = indicator)) +
  geom_line() +
  facet_grid(. ~ ed_name) +
  labs(
    x = &quot;Start Date&quot;,
    y = &quot;Average Value&quot;,
    title = &quot;Differences in Indicators by Education Levels (2021-2022)&quot;) +
  theme_gray() +
  theme(
    legend.position = &quot;bottom&quot;,
    axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)  # Rotate x-axis labels vertically
  ) +
  scale_color_hue(h = c(100, 300)) +
  guides(color = guide_legend(nrow = 2)) # Adding the legend guide adjustment

#View the education plot
ed_plot</code></pre>
<p><img src="eda_files/figure-html/unnamed-chunk-28-1.png" width="90%" /></p>
<p>Critical findings:</p>
<p>Among four education groups, the bachelor’s degree or higher and some
college/ associate’s degree groups have the highest value of taking
prescription medication for mental health and/or received counseling.
This is because individuals with higher education typically have better
jobs, more money, and many other benefits, including better health
insurance, which leads to better access to quality mental health
services than those with a lower education level. On the other hand,
those who have a lower education level (high school diploma or GED and
less than high school diploma groups) have the least value of needed
counseling or therapy but did not get it and received counseling or
therapy indicators because they might not have adequate resources to the
services which resulting having the lowest values in term of the
utilization of the counseling services.</p>
</div>
<div id="gender" class="section level3">
<h3>Gender</h3>
<p>Trends in mental health access by gender were stark. Women reported
needing almost twice as much counseling or therapy for mental health as
men, and these trends were consistent from 2020 to 2022.</p>
<p>Women took more prescription medication for mental health and
received more counseling or therapy for mental health than men. These
trends slightly increased each year from 2020 to 2022.</p>
<p><img src="eda_files/figure-html/gender-1.png" width="90%" /></p>
</div>
<div id="sexual-orientation" class="section level3">
<h3>Sexual Orientation</h3>
<p>Mental health access strongly differed by sexual orientation.
Bisexual Americans reported the highest trends in both taking
prescription medication and/or receiving counseling for mental health
and needing counseling or therapy but not receiving it. Their outcomes
showed the most variation over time. Straight Americans consistently
reported the least unmet need for counseling or therapy.</p>
<p><img src="eda_files/figure-html/sexuality-1.png" width="90%" /></p>
</div>
<div id="raceethnicity" class="section level3">
<h3>Race/ethnicity</h3>
<p>The graph below explores differences in outcome variables by
race/ethnicity. Trends by racial and ethnic groups were stark across all
three years. Non-Hispanic Multiracial Americans, closely followed by
non-Hispanic White Americans, received the most prescription medication
and/or counseling or therapy for mental health. However, non-Hispanic
multiracial Americans needed counseling or therapy for mental health but
did not receive it.</p>
<p><img src="eda_files/figure-html/race%20ethnicity-1.png" width="90%" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
